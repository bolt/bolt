!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/comment/continuecomment.js",["../../lib/codemirror"],a):a(CodeMirror)}(function(a){function m(g){if(g.getOption("disableInput"))return a.Pass;for(var c,b=g.listSelections(),f=[],h=0;h<b.length;h++){var r=b[h].head;if(!/\bcomment\b/.test(g.getTokenTypeAt(r)))return a.Pass;var q=g.getModeAt(r);if(c){if(c!=q)return a.Pass}else c=q;q=null;if(c.blockCommentStart&&
c.blockCommentContinue){var p,l=g.getLine(r.line).slice(0,r.ch),d=l.lastIndexOf(c.blockCommentEnd);if(-1==d||d!=r.ch-c.blockCommentEnd.length)if(-1<(p=l.lastIndexOf(c.blockCommentStart))&&p>d){if(q=l.slice(0,p),/\S/.test(q))for(q="",l=0;l<p;++l)q+=" "}else-1<(p=l.indexOf(c.blockCommentContinue))&&!/\S/.test(l.slice(0,p))&&(q=l.slice(0,p));null!=q&&(q+=c.blockCommentContinue)}null==q&&c.lineComment&&n(g)&&(l=g.getLine(r.line),p=l.indexOf(c.lineComment),-1<p&&(q=l.slice(0,p),/\S/.test(q)?q=null:q+=
c.lineComment+l.slice(p+c.lineComment.length).match(/^\s*/)[0]));if(null==q)return a.Pass;f[h]="\n"+q}g.operation(function(){for(var d=b.length-1;0<=d;d--)g.replaceRange(f[d],b[d].from(),b[d].to(),"+insert")})}function n(a){a=a.getOption("continueComments");return!a||"object"!=typeof a||!1!==a.continueLineComment}a.defineOption("continueComments",null,function(g,c,b){if(b&&b!=a.Init&&g.removeKeyMap("continueComment"),c)b="Enter","string"==typeof c?b=c:"object"==typeof c&&c.key&&(b=c.key),c={name:"continueComment"},
c[b]=m,g.addKeyMap(c)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/closebrackets.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(d,e){return"pairs"==e&&"string"==typeof d?d:"object"==typeof d&&null!=d[e]?d[e]:q[e]}function n(d){for(var e=0;e<d.length;e++){var k=d.charAt(e),b="'"+k+"'";l[b]||(l[b]=g(k))}}function g(d){return function(e){return b(e,d)}}function c(d){var e=d.state.closeBrackets;
return!e||e.override?e:d.getModeAt(d.getCursor()).closeBrackets||e}function b(d,e){var k=c(d);if(!k||d.getOption("disableInput"))return a.Pass;var b=m(k,"pairs"),h=b.indexOf(e);if(-1==h)return a.Pass;for(var l,k=m(k,"triples"),q=b.charAt(h+1)==e,g=d.listSelections(),n=0==h%2,C=0;C<g.length;C++){var w,z=g[C],v=z.head;w=d.getRange(v,p(v.line,v.ch+1));if(n&&!z.empty())w="surround";else if(!q&&n||w!=e)if(q&&1<v.ch&&0<=k.indexOf(e)&&d.getRange(p(v.line,v.ch-2),v)==e+e){if(2<v.ch&&/\bstring/.test(d.getTokenTypeAt(p(v.line,
v.ch-2))))return a.Pass;w="addFour"}else{if(q){if(z=0==v.ch?" ":d.getRange(p(v.line,v.ch-1),v),a.isWordChar(w)||z==e||a.isWordChar(z))return a.Pass}else if(!n||d.getLine(v.line).length!=v.ch&&!f(w,b)&&!/\s/.test(w))return a.Pass;w="both"}else w=q&&r(d,v)?"both":0<=k.indexOf(e)&&d.getRange(v,p(v.line,v.ch+3))==e+e+e?"skipThree":"skip";if(l){if(l!=w)return a.Pass}else l=w}var x=h%2?b.charAt(h-1):e,D=h%2?e:b.charAt(h+1);d.operation(function(){if("skip"==l)d.execCommand("goCharRight");else if("skipThree"==
l)for(var e=0;3>e;e++)d.execCommand("goCharRight");else if("surround"==l){for(var k=d.getSelections(),e=0;e<k.length;e++)k[e]=x+k[e]+D;d.replaceSelections(k,"around");k=d.listSelections().slice();for(e=0;e<k.length;e++){var b=k,c=e,t;t=k[e];var h=0<a.cmpPos(t.anchor,t.head);t={anchor:new p(t.anchor.line,t.anchor.ch+(h?-1:1)),head:new p(t.head.line,t.head.ch+(h?1:-1))};b[c]=t}d.setSelections(k)}else"both"==l?(d.replaceSelection(x+D,null),d.triggerElectric(x+D),d.execCommand("goCharLeft")):"addFour"==
l&&(d.replaceSelection(x+x+x+x,"before"),d.execCommand("goCharRight"))})}function f(d,e){var k=e.lastIndexOf(d);return-1<k&&1==k%2}function h(d,e){var k=d.getRange(p(e.line,e.ch-1),p(e.line,e.ch+1));return 2==k.length?k:null}function r(d,e){var k=d.getTokenAt(p(e.line,e.ch+1));return/\bstring/.test(k.type)&&k.start==e.ch&&(0==e.ch||!/\bstring/.test(d.getTokenTypeAt(e)))}var q={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},p=a.Pos;a.defineOption("autoCloseBrackets",!1,function(d,e,k){k&&k!=a.Init&&
(d.removeKeyMap(l),d.state.closeBrackets=null);e&&(n(m(e,"pairs")),d.state.closeBrackets=e,d.addKeyMap(l))});var l={Backspace:function(d){var e=c(d);if(!e||d.getOption("disableInput"))return a.Pass;for(var k=m(e,"pairs"),e=d.listSelections(),b=0;b<e.length;b++){if(!e[b].empty())return a.Pass;var f=h(d,e[b].head);if(!f||0!=k.indexOf(f)%2)return a.Pass}for(b=e.length-1;0<=b;b--)k=e[b].head,d.replaceRange("",p(k.line,k.ch-1),p(k.line,k.ch+1),"+delete")},Enter:function(d){var e=c(d),e=e&&m(e,"explode");
if(!e||d.getOption("disableInput"))return a.Pass;for(var k=d.listSelections(),b=0;b<k.length;b++){if(!k[b].empty())return a.Pass;var f=h(d,k[b].head);if(!f||0!=e.indexOf(f)%2)return a.Pass}d.operation(function(){var e=d.lineSeparator()||"\n";d.replaceSelection(e+e,null);d.execCommand("goCharLeft");k=d.listSelections();for(e=0;e<k.length;e++){var b=k[e].head.line;d.indentLine(b,null,!0);d.indentLine(b+1,null,!0)}})}};n(q.pairs+"`")});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/xml-fold",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(d,e,b,a){this.line=e;this.ch=b;this.cm=d;this.text=d.getLine(e);this.min=a?Math.max(a.from,d.firstLine()):d.firstLine();this.max=a?Math.min(a.to-1,d.lastLine()):d.lastLine()}function n(d,e){var b=d.cm.getTokenTypeAt(p(d.line,e));return b&&/\btag\b/.test(b)}function g(d){if(!(d.line>=
d.max))return d.ch=0,d.text=d.cm.getLine(++d.line),!0}function c(d){if(!(d.line<=d.min))return d.text=d.cm.getLine(--d.line),d.ch=d.text.length,!0}function b(d){for(;;){var e=d.text.indexOf("\x3e",d.ch);if(-1==e){if(g(d))continue;break}if(n(d,e+1)){var b=d.text.lastIndexOf("/",e),b=-1<b&&!/\S/.test(d.text.slice(b+1,e));return d.ch=e+1,b?"selfClose":"regular"}d.ch=e+1}}function f(d){for(;;){var e=d.ch?d.text.lastIndexOf("\x3c",d.ch-1):-1;if(-1==e){if(c(d))continue;break}if(n(d,e+1)){l.lastIndex=e;
d.ch=e;var b=l.exec(d.text);if(b&&b.index==e)return b}else d.ch=e}}function h(d){for(;;){l.lastIndex=d.ch;var b=l.exec(d.text);if(!b){if(g(d))continue;break}if(n(d,b.index+1))return d.ch=b.index+b[0].length,b;d.ch=b.index+1}}function r(d,e){for(var k=[];;){var a,c=h(d),f=d.line,r=d.ch-(c?c[0].length:0);if(!c||!(a=b(d)))break;if("selfClose"!=a)if(c[1]){for(var l=k.length-1;0<=l;--l)if(k[l]==c[2]){k.length=l;break}if(0>l&&(!e||e==c[2]))return{tag:c[2],from:p(f,r),to:p(d.line,d.ch)}}else k.push(c[2])}}
function q(d,b){for(var k=[];;){var a;a:for(a=d;;){var h=a.ch?a.text.lastIndexOf("\x3e",a.ch-1):-1;if(-1==h){if(c(a))continue;a=void 0;break a}if(n(a,h+1)){var l=a.text.lastIndexOf("/",h),l=-1<l&&!/\S/.test(a.text.slice(l+1,h));a=(a.ch=h+1,l?"selfClose":"regular");break a}a.ch=h}if(!a)break;if("selfClose"!=a){a=d.line;h=d.ch;l=f(d);if(!l)break;if(l[1])k.push(l[2]);else{for(var r=k.length-1;0<=r;--r)if(k[r]==l[2]){k.length=r;break}if(0>r&&(!b||b==l[2]))return{tag:l[2],from:p(d.line,d.ch),to:p(a,h)}}}else f(d)}}
var p=a.Pos,l=RegExp("\x3c(/?)([A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");a.registerHelper("fold","xml",function(d,e){for(var a=new m(d,e.line,0);;){var c,
l=h(a);if(!l||!(c=b(a))||a.line!=e.line)break;if(!l[1]&&"selfClose"!=c)return c=p(a.line,a.ch),(a=r(a,l[2]))&&{from:c,to:a.from}}});a.findMatchingTag=function(d,e,a){var c=new m(d,e.line,e.ch,a);if(-1!=c.text.indexOf("\x3e")||-1!=c.text.indexOf("\x3c")){var l=b(c),h=l&&p(c.line,c.ch),g=l&&f(c);if(l&&g&&!(0<(c.line-e.line||c.ch-e.ch)))return e={from:p(c.line,c.ch),to:h,tag:g[2]},"selfClose"==l?{open:e,close:null,at:"open"}:g[1]?{open:q(c,g[2]),close:e,at:"close"}:(c=new m(d,h.line,h.ch,a),{open:e,
close:r(c,g[2]),at:"open"})}};a.findEnclosingTag=function(d,b,a,c){for(var l=new m(d,b.line,b.ch,a);;){var h=q(l,c);if(!h)break;var f=new m(d,b.line,b.ch,a);if(f=r(f,h.tag))return{open:h,close:f}}};a.scanForClosingTag=function(b,a,c,h){return r(new m(b,a.line,a.ch,h?{from:0,to:h}:null),c)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("addon/edit/closetag.js",["../../lib/codemirror","../fold/xml-fold"],a):a(CodeMirror)})(function(a){function m(h){if(h.getOption("disableInput"))return a.Pass;for(var r=h.listSelections(),q=[],p=h.getOption("autoCloseTags"),l=0;l<r.length;l++){if(!r[l].empty())return a.Pass;var d=r[l].head,e=h.getTokenAt(d),k=a.innerMode(h.getMode(),
e.state),t=k.state;if("xml"!=k.mode.name||!t.tagName)return a.Pass;var u="html"==k.mode.configuration,k="object"==typeof p&&p.dontCloseTags||u&&b,n="object"==typeof p&&p.indentTags||u&&f,u=t.tagName;e.end>d.ch&&(u=u.slice(0,u.length-e.end+d.ch));var m=u.toLowerCase();if(!u||"string"==e.type&&(e.end!=d.ch||!/[\"\']/.test(e.string.charAt(e.string.length-1))||1==e.string.length)||"tag"==e.type&&"closeTag"==t.type||e.string.indexOf("/")==e.string.length-1||k&&-1<g(k,m)||c(h,u,d,t,!0))return a.Pass;e=
n&&-1<g(n,m);q[l]={indent:e,text:"\x3e"+(e?"\n\n":"")+"\x3c/"+u+"\x3e",newPos:e?a.Pos(d.line+1,0):a.Pos(d.line,d.ch+1)}}p="object"==typeof p&&p.dontIndentOnAutoClose;for(l=r.length-1;0<=l;l--)d=q[l],h.replaceRange(d.text,r[l].head,r[l].anchor,"+insert"),e=h.listSelections().slice(0),e[l]={head:d.newPos,anchor:d.newPos},h.setSelections(e),!p&&d.indent&&(h.indentLine(d.newPos.line,null,!0),h.indentLine(d.newPos.line+1,null,!0))}function n(b,f){for(var q=b.listSelections(),p=[],l=f?"/":"\x3c/",d=b.getOption("autoCloseTags"),
d="object"==typeof d&&d.dontIndentOnSlash,e=0;e<q.length;e++){if(!q[e].empty())return a.Pass;var k=q[e].head,t=b.getTokenAt(k),g=a.innerMode(b.getMode(),t.state),n=g.state;if(f&&("string"==t.type||"\x3c"!=t.string.charAt(0)||t.start!=k.ch-1))return a.Pass;if("xml"!=g.mode.name)if("htmlmixed"==b.getMode().name&&"javascript"==g.mode.name)g=l+"script";else{if("htmlmixed"!=b.getMode().name||"css"!=g.mode.name)return a.Pass;g=l+"style"}else{if(!n.context||!n.context.tagName||c(b,n.context.tagName,k,n))return a.Pass;
g=l+n.context.tagName}"\x3e"!=b.getLine(k.line).charAt(t.end)&&(g+="\x3e");p[e]=g}if(b.replaceSelections(p),q=b.listSelections(),!d)for(e=0;e<q.length;e++)(e==q.length-1||q[e].head.line<q[e+1].head.line)&&b.indentLine(q[e].head.line)}function g(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0,f=b.length;c<f;++c)if(b[c]==a)return c;return-1}function c(b,c,f,p,l){if(!a.scanForClosingTag)return!1;var d=Math.min(b.lastLine()+1,f.line+500);f=a.scanForClosingTag(b,f,null,d);if(!f||f.tag!=c)return!1;p=
p.context;for(l=l?1:0;p&&p.tagName==c;p=p.prev)++l;f=f.to;for(p=1;p<l;p++){f=a.scanForClosingTag(b,f,null,d);if(!f||f.tag!=c)return!1;f=f.to}return!0}a.defineOption("autoCloseTags",!1,function(b,c,f){if(f!=a.Init&&f&&b.removeKeyMap("autoCloseTags"),c)f={name:"autoCloseTags"},("object"!=typeof c||c.whenClosing)&&(f["'/'"]=function(b){return b.getOption("disableInput")?a.Pass:n(b,!0)}),("object"!=typeof c||c.whenOpening)&&(f["'\x3e'"]=function(b){return m(b)}),b.addKeyMap(f)});var b="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),
f="applet blockquote body button div dl fieldset form frameset h1 h2 h3 h4 h5 h6 head html iframe layer legend object ol p select table ul".split(" ");a.commands.closeTag=function(b){return n(b)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/matchbrackets.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(b,a,c){var l=b.getLineHandle(a.line),d=a.ch-1,e=c&&c.afterCursor;null==e&&(e=/(^| )cm-fat-cursor($| )/.test(b.getWrapperElement().className));l=!e&&0<=d&&h[l.text.charAt(d)]||h[l.text.charAt(++d)];if(!l)return null;e="\x3e"==l.charAt(1)?1:-1;if(c&&c.strict&&0<e!=
(d==a.ch))return null;var k=b.getTokenTypeAt(f(a.line,d+1));b=n(b,f(a.line,d+(0<e?1:0)),e,k||null,c);return null==b?null:{from:f(a.line,d),to:b&&b.pos,match:b&&b.ch==l.charAt(0),forward:0<e}}function n(b,a,c,l,d){var e=d&&d.maxScanLineLength||1E4,k=d&&d.maxScanLines||1E3,t=[];d=d&&d.bracketRegex?d.bracketRegex:/[(){}[\]]/;for(var k=0<c?Math.min(a.line+k,b.lastLine()+1):Math.max(b.firstLine()-1,a.line-k),g=a.line;g!=k;g+=c){var n=b.getLine(g);if(n){var m=0<c?0:n.length-1,E=0<c?n.length:-1;if(!(n.length>
e))for(g==a.line&&(m=a.ch-(0>c?1:0));m!=E;m+=c){var A=n.charAt(m);if(d.test(A)&&(void 0===l||b.getTokenTypeAt(f(g,m+1))==l))if("\x3e"==h[A].charAt(1)==0<c)t.push(A);else{if(!t.length)return{pos:f(g,m),ch:A};t.pop()}}}}return g-c!=(0<c?b.lastLine():b.firstLine())&&null}function g(a,c,h){for(var l=a.state.matchBrackets.maxHighlightLineLength||1E3,d=[],e=a.listSelections(),k=0;k<e.length;k++){var g=e[k].empty()&&m(a,e[k].head,h);if(g&&a.getLine(g.from.line).length<=l){var n=g.match?"CodeMirror-matchingbracket":
"CodeMirror-nonmatchingbracket";d.push(a.markText(g.from,f(g.from.line,g.from.ch+1),{className:n}));g.to&&a.getLine(g.to.line).length<=l&&d.push(a.markText(g.to,f(g.to.line,g.to.ch+1),{className:n}))}}if(d.length){b&&a.state.focused&&a.focus();h=function(){a.operation(function(){for(var b=0;b<d.length;b++)d[b].clear()})};if(!c)return h;setTimeout(h,800)}}function c(b){b.operation(function(){b.state.matchBrackets.currentlyHighlighted&&(b.state.matchBrackets.currentlyHighlighted(),b.state.matchBrackets.currentlyHighlighted=
null);b.state.matchBrackets.currentlyHighlighted=g(b,!1,b.state.matchBrackets)})}var b=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||8>document.documentMode),f=a.Pos,h={"(":")\x3e",")":"(\x3c","[":"]\x3e","]":"[\x3c","{":"}\x3e","}":"{\x3c"};a.defineOption("matchBrackets",!1,function(b,f,h){h&&h!=a.Init&&(b.off("cursorActivity",c),b.state.matchBrackets&&b.state.matchBrackets.currentlyHighlighted&&(b.state.matchBrackets.currentlyHighlighted(),b.state.matchBrackets.currentlyHighlighted=
null));f&&(b.state.matchBrackets="object"==typeof f?f:{},b.on("cursorActivity",c))});a.defineExtension("matchBrackets",function(){g(this,!0)});a.defineExtension("findMatchingBracket",function(b,a,c){return(c||"boolean"==typeof a)&&(c?(c.strict=a,a=c):a=a?{strict:!0}:null),m(this,b,a)});a.defineExtension("scanForBracket",function(b,a,c,f){return n(this,b,a,c,f)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("addon/edit/matchtags.js",["../../lib/codemirror","../fold/xml-fold"],a):a(CodeMirror)})(function(a){function m(a){a.state.tagHit&&a.state.tagHit.clear();a.state.tagOther&&a.state.tagOther.clear();a.state.tagHit=a.state.tagOther=null}function n(c){c.state.failedTagMatch=!1;c.operation(function(){if(m(c),!c.somethingSelected()){var b=
c.getCursor(),f=c.getViewport();f.from=Math.min(f.from,b.line);f.to=Math.max(b.line+1,f.to);if(b=a.findMatchingTag(c,b,f))c.state.matchBothTags&&(f="open"==b.at?b.open:b.close)&&(c.state.tagHit=c.markText(f.from,f.to,{className:"CodeMirror-matchingtag"})),(b="close"==b.at?b.open:b.close)?c.state.tagOther=c.markText(b.from,b.to,{className:"CodeMirror-matchingtag"}):c.state.failedTagMatch=!0}})}function g(a){a.state.failedTagMatch&&n(a)}a.defineOption("matchTags",!1,function(c,b,f){f&&f!=a.Init&&(c.off("cursorActivity",
n),c.off("viewportChange",g),m(c));b&&(c.state.matchBothTags="object"==typeof b&&b.bothTags,c.on("cursorActivity",n),c.on("viewportChange",g),n(c))});a.commands.toMatchingTag=function(c){var b=a.findMatchingTag(c,c.getCursor());b&&(b="close"==b.at?b.open:b.close)&&c.extendSelection(b.to,b.from)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/trailingspace.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.defineOption("showTrailingSpace",!1,function(m,n,g){g==a.Init&&(g=!1);g&&!n?m.removeOverlay("trailingspace"):!g&&n&&m.addOverlay({token:function(a){for(var b=a.string.length,f=b;f&&/\s/.test(a.string.charAt(f-1));--f);return f>a.pos?(a.pos=f,null):(a.pos=b,"trailingspace")},
name:"trailingspace"})})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/foldcode",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(b,c,h,r){function q(a){var d=p(b,c);if(!d||d.to.line-d.from.line<l)return null;for(var e=b.findMarksAt(d.from),k=0;k<e.length;++k)if(e[k].__isFold&&"fold"!==r){if(!a)return null;d.cleared=!0;e[k].clear()}return d}if(h&&h.call){var p=h;h=null}else p=g(b,h,"rangeFinder");
"number"==typeof c&&(c=a.Pos(c,0));var l=g(b,h,"minFoldSize"),d=q(!0);if(g(b,h,"scanUp"))for(;!d&&c.line>b.firstLine();)c=a.Pos(c.line-1,0),d=q(!1);if(d&&!d.cleared&&"unfold"!==r){var e=n(b,h);a.on(e,"mousedown",function(b){k.clear();a.e_preventDefault(b)});var k=b.markText(d.from,d.to,{replacedWith:e,clearOnEnter:g(b,h,"clearOnEnter"),__isFold:!0});k.on("clear",function(d,c){a.signal(b,"unfold",b,d,c)});a.signal(b,"fold",b,d.from,d.to)}}function n(b,a){var c=g(b,a,"widget");if("string"==typeof c){var r=
document.createTextNode(c),c=document.createElement("span");c.appendChild(r);c.className="CodeMirror-foldmarker"}else c&&(c=c.cloneNode(!0));return c}function g(b,a,h){return a&&void 0!==a[h]?a[h]:(b=b.options.foldOptions)&&void 0!==b[h]?b[h]:c[h]}a.newFoldFunction=function(b,a){return function(c,g){m(c,g,{rangeFinder:b,widget:a})}};a.defineExtension("foldCode",function(b,a,c){m(this,b,a,c)});a.defineExtension("isFolded",function(b){b=this.findMarksAt(b);for(var a=0;a<b.length;++a)if(b[a].__isFold)return!0});
a.commands.toggleFold=function(b){b.foldCode(b.getCursor())};a.commands.fold=function(b){b.foldCode(b.getCursor(),null,"fold")};a.commands.unfold=function(b){b.foldCode(b.getCursor(),null,"unfold")};a.commands.foldAll=function(b){b.operation(function(){for(var c=b.firstLine(),h=b.lastLine();c<=h;c++)b.foldCode(a.Pos(c,0),null,"fold")})};a.commands.unfoldAll=function(b){b.operation(function(){for(var c=b.firstLine(),h=b.lastLine();c<=h;c++)b.foldCode(a.Pos(c,0),null,"unfold")})};a.registerHelper("fold",
"combine",function(){var b=Array.prototype.slice.call(arguments,0);return function(a,c){for(var g=0;g<b.length;++g){var n=b[g](a,c);if(n)return n}}});a.registerHelper("fold","auto",function(b,a){for(var c=b.getHelpers(a,"fold"),g=0;g<c.length;g++){var n=c[g](b,a);if(n)return n}});var c={rangeFinder:a.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1,clearOnEnter:!0};a.defineOption("foldOptions",null);a.defineExtension("foldOption",function(b,a){return g(this,b,a)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define("addon/fold/foldgutter.js",["../../lib/codemirror","./foldcode"],a):a(CodeMirror)})(function(a){function m(b){this.options=b;this.from=this.to=0}function n(b,a){for(var c=b.findMarks(p(a,0),p(a+1,0)),k=0;k<c.length;++k)if(c[k].__isFold&&c[k].find().from.line==a)return c[k]}function g(b){if("string"==typeof b){var a=document.createElement("div");
return a.className=b+" CodeMirror-guttermarker-subtle",a}return b.cloneNode(!0)}function c(b,a,c){var k=b.state.foldGutter.options,f=a,h=b.foldOption(k,"minFoldSize"),r=b.foldOption(k,"rangeFinder");b.eachLine(a,c,function(a){var c=null;if(n(b,f))c=g(k.indicatorFolded);else{var d=p(f,0);(d=r&&r(b,d))&&d.to.line-d.from.line>=h&&(c=g(k.indicatorOpen))}b.setGutterMarker(a,k.gutter,c);++f})}function b(b){var a=b.getViewport(),e=b.state.foldGutter;e&&(b.operation(function(){c(b,a.from,a.to)}),e.from=a.from,
e.to=a.to)}function f(b,a,c){var k=b.state.foldGutter;k&&(k=k.options,c==k.gutter&&((c=n(b,a))?c.clear():b.foldCode(p(a,0),k.rangeFinder)))}function h(a){var c=a.state.foldGutter;if(c){var e=c.options;c.from=c.to=0;clearTimeout(c.changeUpdate);c.changeUpdate=setTimeout(function(){b(a)},e.foldOnChangeTimeSpan||600)}}function r(a){var d=a.state.foldGutter;if(d){var e=d.options;clearTimeout(d.changeUpdate);d.changeUpdate=setTimeout(function(){var e=a.getViewport();d.from==d.to||20<e.from-d.to||20<d.from-
e.to?b(a):a.operation(function(){e.from<d.from&&(c(a,e.from,d.from),d.from=e.from);e.to>d.to&&(c(a,d.to,e.to),d.to=e.to)})},e.updateViewportTimeSpan||400)}}function q(b,a){var e=b.state.foldGutter;if(e){var k=a.line;k>=e.from&&k<e.to&&c(b,k,k+1)}}a.defineOption("foldGutter",!1,function(c,d,e){e&&e!=a.Init&&(c.clearGutter(c.state.foldGutter.options.gutter),c.state.foldGutter=null,c.off("gutterClick",f),c.off("change",h),c.off("viewportChange",r),c.off("fold",q),c.off("unfold",q),c.off("swapDoc",h));
if(d){e=c.state;var k=d;d=(!0===k&&(k={}),null==k.gutter&&(k.gutter="CodeMirror-foldgutter"),null==k.indicatorOpen&&(k.indicatorOpen="CodeMirror-foldgutter-open"),null==k.indicatorFolded&&(k.indicatorFolded="CodeMirror-foldgutter-folded"),k);e.foldGutter=new m(d);b(c);c.on("gutterClick",f);c.on("change",h);c.on("viewportChange",r);c.on("fold",q);c.on("unfold",q);c.on("swapDoc",h)}});var p=a.Pos});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/brace-fold.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.registerHelper("fold","brace",function(m,n){function g(d){for(var e=n.ch,k=0;;)if(e=0>=e?-1:f.lastIndexOf(d,e-1),-1!=e){if(1==k&&e<n.ch)break;if(c=m.getTokenTypeAt(a.Pos(b,e+1)),!/^(comment|string)/.test(c))return e+1;--e}else{if(1==k)break;k=1;e=f.length}}var c,b=n.line,f=
m.getLine(b),h="{",r="}",q=g("{");if(null==q&&(h="[",r="]",q=g("[")),null!=q){var p,l,d=1,e=m.lastLine(),k=b;a:for(;k<=e;++k)for(var t=m.getLine(k),u=k==b?q:0;;){var y=t.indexOf(h,u),B=t.indexOf(r,u);if(0>y&&(y=t.length),0>B&&(B=t.length),(u=Math.min(y,B))==t.length)break;if(m.getTokenTypeAt(a.Pos(k,u+1))==c)if(u==y)++d;else if(!--d){p=k;l=u;break a}++u}if(null!=p&&(b!=p||l!=q))return{from:a.Pos(b,q),to:a.Pos(p,l)}}});a.registerHelper("fold","import",function(m,n){function g(b){if(b<m.firstLine()||
b>m.lastLine())return null;var c=m.getTokenAt(a.Pos(b,1));if(/\S/.test(c.string)||(c=m.getTokenAt(a.Pos(b,c.end+1))),"keyword"!=c.type||"import"!=c.string)return null;var f=b;for(b=Math.min(m.lastLine(),b+10);f<=b;++f){var g=m.getLine(f).indexOf(";");if(-1!=g)return{startCh:c.end,end:a.Pos(f,g)}}}var c,b=n.line,f=g(b);if(!f||g(b-1)||(c=g(b-2))&&c.end.line==b-1)return null;for(c=f.end;;){var h=g(c.line+1);if(null==h)break;c=h.end}return{from:m.clipPos(a.Pos(b,f.startCh+1)),to:c}});a.registerHelper("fold",
"include",function(m,n){function g(b){if(b<m.firstLine()||b>m.lastLine())return null;var c=m.getTokenAt(a.Pos(b,1));return/\S/.test(c.string)||(c=m.getTokenAt(a.Pos(b,c.end+1))),"meta"==c.type&&"#include"==c.string.slice(0,8)?c.start+8:void 0}var c=n.line,b=g(c);if(null==b||null!=g(c-1))return null;for(var f=c;null!=g(f+1);)++f;return{from:a.Pos(c,b+1),to:m.clipPos(a.Pos(f))}})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/comment-fold.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.registerGlobalHelper("fold","comment",function(a){return a.blockCommentStart&&a.blockCommentEnd},function(m,n){var g=m.getModeAt(n),c=g.blockCommentStart,g=g.blockCommentEnd;if(c&&g){var b,f=n.line;b=m.getLine(f);for(var h=n.ch,r=0;;)if(h=0>=h?-1:b.lastIndexOf(c,h-1),-1!=
h){if(1==r&&h<n.ch)return;if(/comment/.test(m.getTokenTypeAt(a.Pos(f,h+1)))&&(0==h||b.slice(h-g.length,h)==g||!/comment/.test(m.getTokenTypeAt(a.Pos(f,h))))){b=h+c.length;break}--h}else{if(1==r)return;r=1;h=b.length}var q,p,r=1,h=m.lastLine(),l=f;a:for(;l<=h;++l)for(var d=m.getLine(l),e=l==f?b:0;;){var k=d.indexOf(c,e),t=d.indexOf(g,e);if(0>k&&(k=d.length),0>t&&(t=d.length),(e=Math.min(k,t))==d.length)break;if(e==k)++r;else if(!--r){q=l;p=e;break a}++e}if(null!=q&&(f!=q||p!=b))return{from:a.Pos(f,
b),to:a.Pos(q,p)}}})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/indent-fold.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(n,g){var c=n.getLine(g),b=c.search(/\S/);return-1==b||/\bcomment\b/.test(n.getTokenTypeAt(a.Pos(g,b+1)))?-1:a.countColumn(c,null,n.getOption("tabSize"))}a.registerHelper("fold","indent",function(n,g){var c=m(n,g.line);if(!(0>c)){for(var b=null,f=g.line+1,h=n.lastLine();f<=
h;++f){var r=m(n,f);if(-1!=r){if(!(r>c))break;b=f}}return b?{from:a.Pos(g.line,n.getLine(g.line).length),to:a.Pos(b,n.getLine(b).length)}:void 0}})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/format/autoFormatAll.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.defineExtension("autoFormatAll",function(m,n){for(var g=this,c=g.getMode(),b=g.getRange(m,n).split("\n"),f=a.copyState(c,g.getTokenAt(m).state),h=g.getOption("tabSize"),r="",q=0,p=0==m.ch,l=0;l<b.length;++l){for(var d=new a.StringStream(b[l],h);!d.eol();){var e=a.innerMode(c,
f),k=c.token(d,f),t=d.current();d.start=d.pos;p&&!/\S/.test(t)||(r+=t,p=!1);!p&&e.mode.newlineAfterToken&&e.mode.newlineAfterToken(k,t,d.string.slice(d.pos)||b[l+1]||"",e.state)&&(r+="\n",p=!0,++q)}!d.pos&&c.blankLine&&c.blankLine(f);!p&&l<b.length-1&&(r+="\n",p=!0,++q)}g.operation(function(){g.replaceRange(r,m,n);for(var b=m.line+1,a=m.line+q;b<=a;++b)g.indentLine(b,"smart");g.setCursor({line:0,ch:0})})})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/format/formatting.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(a){for(var g=[/for\s*?\((.*?)\)/g,/&#?[a-z0-9]+;[\s\S]/g,/\"(.*?)((\")|$)/g,/\/\*(.*?)(\*\/|$)/g,/^\/\/.*/g],c=[],b=0;b<g.length;b++)for(var f=0;f<a.length;){var h=a.substr(f).match(g[b]);if(null==h)break;c.push({start:f+h.index,end:f+h.index+h[0].length});f+=h.index+
Math.max(1,h[0].length)}return c.sort(function(b,a){return b.start-a.start}),c}a.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(a,g){return/^[;{}]$/.test(g)}});a.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(a){var g=0,c=this.jsonMode?function(b){return b.replace(/([,{])/g,"$1\n").replace(/}/g,"\n}")}:function(b){return b.replace(/(;|\{|\})([^\r\n;])/g,"$1\n$2")},b=m(a),f="";if(null!=b){for(var h=
0;h<b.length;h++)b[h].start>g&&(f+=c(a.substring(g,b[h].start)),g=b[h].start),b[h].start<=g&&b[h].end>=g&&(f+=a.substring(g,b[h].end),g=b[h].end);g<a.length&&(f+=c(a.substr(g)))}else f=c(a);return f.replace(/^\n*|\n*$/,"")}});a.extendMode("xml",{commentStart:"\x3c!--",commentEnd:"--\x3e",noBreak:!1,noBreakEmpty:null,tagType:"",tagName:"",isXML:!1,newlineAfterToken:function(a,g,c,b){b=!1;var f=null,h="";if(this.isXML="xml"==this.configuration,"comment"==a||/\x3c!--/.test(c))return!1;if("tag"==a){0==
g.indexOf("\x3c")&&0==!g.indexOf("\x3c/")&&(this.tagType="open",f=g.match(/^<\s*?([\w]+?)$/i),this.tagName=null!=f?f[1]:"",h=this.tagName.toLowerCase(),-1!="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")&&(this.noBreak=!0));if(0==g.indexOf("\x3e")&&"open"==this.tagType)return this.tagType="",RegExp("^"+(this.isXML?"[^\x3c]*?":"")+"\x3c/s*?"+this.tagName+"s*?\x3e","i").test(c)?(this.noBreak=!1,this.isXML||
(this.tagName=""),!1):(b=this.noBreak,this.noBreak=!1,!b);if(0==g.indexOf("\x3c/")&&(this.tagType="close",f=g.match(/^<\/\s*?([\w]+?)$/i),null!=f&&(h=f[1].toLowerCase()),-1!="|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")&&(this.noBreak=!0)),0==g.indexOf("\x3e")&&"close"==this.tagType)return this.tagType="",0==c.indexOf("\x3c")&&(f=c.match(/^<\/?\s*?([\w]+?)(\s|>)/i),h=null!=f?f[1].toLowerCase():"",-1=="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+
h+"|"))?(this.noBreak=!1,!0):(b=this.noBreak,this.noBreak=!1,!b)}return 0==c.indexOf("\x3c")&&(this.noBreak=!1,this.isXML&&""!=this.tagName?(this.tagName="",!1):(f=c.match(/^<\/?\s*?([\w]+?)(\s|>)/i),h=null!=f?f[1].toLowerCase():"",-1=="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")))}});a.defineExtension("commentRange",function(n,g,c){var b=this,f=a.innerMode(b.getMode(),b.getTokenAt(g).state).mode;b.operation(function(){if(n)b.replaceRange(f.commentEnd,
c),b.replaceRange(f.commentStart,g),b.setSelection(g,{line:c.line,ch:c.ch+f.commentStart.length+f.commentEnd.length}),g.line==c.line&&g.ch==c.ch&&b.setCursor(g.line,g.ch+f.commentStart.length);else{var a=b.getRange(g,c),r=a.indexOf(f.commentStart),q=a.lastIndexOf(f.commentEnd);-1<r&&-1<q&&q>r&&(a=a.substr(0,r)+a.substring(r+f.commentStart.length,q)+a.substr(q+f.commentEnd.length));b.replaceRange(a,g,c);b.setSelection(g,{line:c.line,ch:c.ch-f.commentStart.length-f.commentEnd.length})}})});a.defineExtension("autoIndentRange",
function(a,g){var c=this;this.operation(function(){for(var b=a.line;b<=g.line;b++)c.indentLine(b,"smart")})});a.defineExtension("autoFormatRange",function(n,g){for(var c=this,b=c.getMode(),f=c.getRange(n,g).split("\n"),h=a.copyState(b,c.getTokenAt(n).state),r=c.getOption("tabSize"),q="",p=0,l=0==n.ch,d=0;d<f.length;++d){for(var e=new a.StringStream(f[d],r);!e.eol();){var k=a.innerMode(b,h),t=b.token(e,h),m=e.current();e.start=e.pos;l&&!/\S/.test(m)||(q+=m,l=!1);!l&&k.mode.newlineAfterToken&&k.mode.newlineAfterToken(t,
m,e.string.slice(e.pos)||f[d+1]||"",k.state)&&(q+="\n",l=!0,++p)}!e.pos&&b.blankLine&&b.blankLine(h);!l&&d<f.length-1&&(q+="\n",l=!0,++p)}c.operation(function(){c.replaceRange(q,n,g);for(var b=n.line+1,a=n.line+p;b<=a;++b)c.indentLine(b,"smart");c.setSelection(n,c.getCursor(!1))})})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/selection/active-line.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(a){for(var c=0;c<a.state.activeLines.length;c++)a.removeLineClass(a.state.activeLines[c],"wrap",b),a.removeLineClass(a.state.activeLines[c],"background",f),a.removeLineClass(a.state.activeLines[c],"gutter",h)}function n(b,a){if(b.length!=a.length)return!1;for(var c=
0;c<b.length;c++)if(b[c]!=a[c])return!1;return!0}function g(a,c){for(var g=[],l=0;l<c.length;l++){var d=c[l],e=a.getOption("styleActiveLine");if("object"==typeof e&&e.nonEmpty?d.anchor.line==d.head.line:d.empty())d=a.getLineHandleVisualStart(d.head.line),g[g.length-1]!=d&&g.push(d)}n(a.state.activeLines,g)||a.operation(function(){m(a);for(var c=0;c<g.length;c++)a.addLineClass(g[c],"wrap",b),a.addLineClass(g[c],"background",f),a.addLineClass(g[c],"gutter",h);a.state.activeLines=g})}function c(a,b){g(a,
b.ranges)}var b="CodeMirror-activeline",f="CodeMirror-activeline-background",h="CodeMirror-activeline-gutter";a.defineOption("styleActiveLine",!1,function(b,f,h){h=h!=a.Init&&h;f!=h&&(h&&(b.off("beforeSelectionChange",c),m(b),delete b.state.activeLines),f&&(b.state.activeLines=[],g(b,b.listSelections()),b.on("beforeSelectionChange",c)))})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/search/searchcursor",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(b,a){var c;c=b.flags;for(var d=c=null!=c?c:(b.ignoreCase?"i":"")+(b.global?"g":"")+(b.multiline?"m":""),e=0;e<a.length;e++)-1==d.indexOf(a.charAt(e))&&(d+=a.charAt(e));return c==d?b:new RegExp(b.source,d)}function n(b,a,c){a=m(a,"g");var d=c.line,f=c.ch;for(c=b.lastLine();d<=
c;d++,f=0)if(a.lastIndex=f,f=b.getLine(d),f=a.exec(f))return{from:e(d,f.index),to:e(d,f.index+f[0].length),match:f}}function g(b,a,c){if(!/\\s|\\n|\n|\\W|\\D|\[\^/.test(a.source))return n(b,a,c);a=m(a,"gm");for(var d,f=1,g=c.line,h=b.lastLine();g<=h;){for(var l=0;l<f&&!(g>h);l++){var p=b.getLine(g++);d=null==d?p:d+"\n"+p}f*=2;a.lastIndex=c.ch;if(l=a.exec(d))return a=d.slice(0,l.index).split("\n"),b=l[0].split("\n"),c=c.line+a.length-1,a=a[a.length-1].length,{from:e(c,a),to:e(c+b.length-1,1==b.length?
a+b[0].length:b[b.length-1].length),match:l}}}function c(b,a){for(var c,d=0;;){a.lastIndex=d;var e=a.exec(b);if(!e||(c=e,(d=c.index+(c[0].length||1))==b.length))return c}}function b(b,a,d){a=m(a,"g");var f=d.line,g=d.ch;for(d=b.firstLine();f>=d;f--,g=-1){var h=b.getLine(f);-1<g&&(h=h.slice(0,g));if(g=c(h,a))return{from:e(f,g.index),to:e(f,g.index+g[0].length),match:g}}}function f(b,a,d){a=m(a,"gm");for(var f,g=1,h=d.line,l=b.firstLine();h>=l;){for(var p=0;p<g;p++){var n=b.getLine(h--);f=null==f?n.slice(0,
d.ch):n+"\n"+f}g*=2;if(p=c(f,a))return a=f.slice(0,p.index).split("\n"),b=p[0].split("\n"),h+=a.length,a=a[a.length-1].length,{from:e(h,a),to:e(h+b.length-1,1==b.length?a+b[0].length:b[b.length-1].length),match:p}}}function h(a,b,c,d){if(a.length==b.length)return c;var e=0;for(b=c+Math.max(0,a.length-b.length);;){if(e==b)return e;var f=e+b>>1,g=d(a.slice(0,f)).length;if(g==c)return f;g>c?b=f:e=f+1}}function r(b,a,c,f){if(!a.length)return null;f=f?l:d;a=f(a).split(/\r|\n\r?/);var g=c.line;c=c.ch;var p=
b.lastLine()+1-a.length;a:for(;g<=p;g++,c=0){var n=b.getLine(g).slice(c),m=f(n);if(1==a.length){var q=m.indexOf(a[0]);if(-1==q)continue a;h(n,m,q,f);return{from:e(g,h(n,m,q,f)+c),to:e(g,h(n,m,q+a[0].length,f)+c)}}q=m.length-a[0].length;if(m.slice(q)==a[0]){for(var r=1;r<a.length-1;r++)if(f(b.getLine(g+r))!=a[r])continue a;var r=b.getLine(g+a.length-1),v=f(r),x=a[a.length-1];if(v.slice(0,x.length)==x)return{from:e(g,h(n,m,q,f)+c),to:e(g+a.length-1,h(r,v,x.length,f))}}}}function q(a,b,c,f){if(!b.length)return null;
f=f?l:d;b=f(b).split(/\r|\n\r?/);var g=c.line,p=c.ch,n=a.firstLine()-1+b.length;a:for(;g>=n;g--,p=-1){var m=a.getLine(g);-1<p&&(m=m.slice(0,p));p=f(m);if(1==b.length){c=p.lastIndexOf(b[0]);if(-1==c)continue a;return{from:e(g,h(m,p,c,f)),to:e(g,h(m,p,c+b[0].length,f))}}var q=b[b.length-1];if(p.slice(0,q.length)==q){var r=1;for(c=g-b.length+1;r<b.length-1;r++)if(f(a.getLine(c+r))!=b[r])continue a;c=a.getLine(g+1-b.length);r=f(c);if(r.slice(r.length-b[0].length)==b[0])return{from:e(g+1-b.length,h(c,
r,c.length-b[0].length,f)),to:e(g,h(m,p,q.length,f))}}}}function p(a,c,d,h){this.atOccurrence=!1;this.doc=a;d=d?a.clipPos(d):e(0,0);this.pos={from:d,to:d};var l;"object"==typeof h?l=h.caseFold:(l=h,h=null);"string"==typeof c?(null==l&&(l=!1),this.matches=function(b,d){return(b?q:r)(a,c,d,l)}):(c=m(c,"gm"),h&&!1===h.multiline?this.matches=function(d,e){return(d?b:n)(a,c,e)}:this.matches=function(b,d){return(b?f:g)(a,c,d)})}var l,d,e=a.Pos;String.prototype.normalize?(l=function(b){return b.normalize("NFD").toLowerCase()},
d=function(b){return b.normalize("NFD")}):(l=function(b){return b.toLowerCase()},d=function(b){return b});p.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(b){for(var c=this.matches(b,this.doc.clipPos(b?this.pos.from:this.pos.to));c&&0==a.cmpPos(c.from,c.to);)b?c.from.ch?c.from=e(c.from.line,c.from.ch-1):c=c.from.line==this.doc.firstLine()?null:this.matches(b,this.doc.clipPos(e(c.from.line-1))):c.to.ch<this.doc.getLine(c.to.line).length?
c.to=e(c.to.line,c.to.ch+1):c=c.to.line==this.doc.lastLine()?null:this.matches(b,e(c.to.line+1,0));if(c)return this.pos=c,this.atOccurrence=!0,this.pos.match||!0;b=e(b?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:b,to:b},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(b,c){if(this.atOccurrence){var d=a.splitLines(b);this.doc.replaceRange(d,this.pos.from,this.pos.to,c);this.pos.to=
e(this.pos.from.line+d.length-1,d[d.length-1].length+(1==d.length?this.pos.from.ch:0))}}};a.defineExtension("getSearchCursor",function(b,a,c){return new p(this.doc,b,a,c)});a.defineDocExtension("getSearchCursor",function(b,a,c){return new p(this,b,a,c)});a.defineExtension("selectMatches",function(b,c){for(var d=[],e=this.getSearchCursor(b,this.getCursor("from"),c);e.findNext()&&!(0<a.cmpPos(e.to(),this.getCursor("to")));)d.push({anchor:e.from(),head:e.to()});d.length&&this.setSelections(d,0)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/scroll/annotatescrollbar",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(a,g){function c(a){clearTimeout(b.doRedraw);b.doRedraw=setTimeout(function(){b.redraw()},a)}this.cm=a;this.options=g;this.buttonHeight=g.scrollButtonHeight||a.getOption("scrollButtonHeight");this.annotations=[];this.doRedraw=this.doUpdate=null;this.div=a.getWrapperElement().appendChild(document.createElement("div"));
this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none";this.computeScale();var b=this;a.on("refresh",this.resizeHandler=function(){clearTimeout(b.doUpdate);b.doUpdate=setTimeout(function(){b.computeScale()&&c(20)},100)});a.on("markerAdded",this.resizeHandler);a.on("markerCleared",this.resizeHandler);!1!==g.listenForChanges&&a.on("change",this.changeHandler=function(){c(250)})}a.defineExtension("annotateScrollbar",function(a){return"string"==typeof a&&(a={className:a}),
new m(this,a)});a.defineOption("scrollButtonHeight",0);m.prototype.computeScale=function(){var a=this.cm,a=(a.getWrapperElement().clientHeight-a.display.barHeight-2*this.buttonHeight)/a.getScrollerElement().scrollHeight;if(a!=this.hScale)return this.hScale=a,!0};m.prototype.update=function(a){this.annotations=a;this.redraw()};m.prototype.redraw=function(a){function g(a,b){return q!=a.line&&(q=a.line,p=c.getLineHandle(q)),p.widgets&&p.widgets.length||h&&p.height>m?c.charCoords(a,"local")[b?"top":"bottom"]:
c.heightAtLine(p,"local")+(b?0:p.height)}!1!==a&&this.computeScale();var c=this.cm;a=this.hScale;var b=document.createDocumentFragment(),f=this.annotations,h=c.getOption("lineWrapping"),m=h&&1.5*c.defaultTextHeight(),q=null,p=null,l=c.lastLine();if(c.display.barWidth)for(var d,e=0;e<f.length;e++){var k=f[e];if(!(k.to.line>l)){for(var t=d||g(k.from,!0)*a,u=g(k.to,!1)*a;e<f.length-1&&!(f[e+1].to.line>l)&&!((d=g(f[e+1].from,!0)*a)>u+.9);)k=f[++e],u=g(k.to,!1)*a;if(u!=t){var u=Math.max(u-t,3),y=b.appendChild(document.createElement("div"));
y.style.cssText="position: absolute; right: 0px; width: "+Math.max(c.display.barWidth-1,2)+"px; top: "+(t+this.buttonHeight)+"px; height: "+u+"px";y.className=this.options.className;k.id&&y.setAttribute("annotation-id",k.id)}}}this.div.textContent="";this.div.appendChild(b)};m.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler);this.cm.off("markerAdded",this.resizeHandler);this.cm.off("markerCleared",this.resizeHandler);this.changeHandler&&this.cm.off("change",this.changeHandler);
this.div.parentNode.removeChild(this.div)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define("addon/search/matchesonscrollbar",["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],a):a(CodeMirror)})(function(a){function m(a,c,b,f){this.cm=a;this.options=f;var h={listenForChanges:!1},m;for(m in f)h[m]=f[m];h.className||(h.className="CodeMirror-search-match");this.annotation=
a.annotateScrollbar(h);this.query=c;this.caseFold=b;this.gap={from:a.firstLine(),to:a.lastLine()+1};this.matches=[];this.update=null;this.findMatches();this.annotation.update(this.matches);var n=this;a.on("change",this.changeHandler=function(a,b){n.onChange(b)})}function n(a,c,b){return a<=c?a:Math.max(c,a+b)}a.defineExtension("showMatchesOnScrollbar",function(a,c,b){return"string"==typeof b&&(b={className:b}),b||(b={}),new m(this,a,c,b)});m.prototype.findMatches=function(){if(this.gap){for(var g=
0;g<this.matches.length;g++){var c=this.matches[g];if(c.from.line>=this.gap.to)break;c.to.line>=this.gap.from&&this.matches.splice(g--,1)}for(var b=this.cm.getSearchCursor(this.query,a.Pos(this.gap.from,0),this.caseFold),f=this.options&&this.options.maxMatches||1E3;b.findNext();){c={from:b.from(),to:b.to()};if(c.from.line>=this.gap.to)break;if(this.matches.splice(g++,0,c),this.matches.length>f)break}this.gap=null}};m.prototype.onChange=function(g){var c=g.from.line,b=a.changeEnd(g).line,f=b-g.to.line;
if(this.gap?(this.gap.from=Math.min(n(this.gap.from,c,f),g.from.line),this.gap.to=Math.max(n(this.gap.to,c,f),g.from.line)):this.gap={from:g.from.line,to:b+1},f)for(g=0;g<this.matches.length;g++){var b=this.matches[g],h=n(b.from.line,c,f);h!=b.from.line&&(b.from=a.Pos(h,b.from.ch));h=n(b.to.line,c,f);h!=b.to.line&&(b.to=a.Pos(h,b.to.ch))}clearTimeout(this.update);var m=this;this.update=setTimeout(function(){m.updateAfterChange()},250)};m.prototype.updateAfterChange=function(){this.findMatches();this.annotation.update(this.matches)};
m.prototype.clear=function(){this.cm.off("change",this.changeHandler);this.annotation.clear()}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define("addon/search/match-highlighter.js",["../../lib/codemirror","./matchesonscrollbar"],a):a(CodeMirror)})(function(a){function m(a){this.options={};for(var b in q)this.options[b]=(a&&a.hasOwnProperty(b)?a:q)[b];this.matchesonscroll=this.overlay=this.timeout=null;this.active=!1}function n(a){var b=a.state.matchHighlighter;(b.active||
a.hasFocus())&&c(a,b)}function g(a){var b=a.state.matchHighlighter;b.active||(b.active=!0,c(a,b))}function c(a,b){clearTimeout(b.timeout);b.timeout=setTimeout(function(){h(a)},b.options.delay)}function b(a,b,c,e){var f=a.state.matchHighlighter;if(a.addOverlay(f.overlay=r(b,c,e)),f.options.annotateScrollbar&&a.showMatchesOnScrollbar)b=c?new RegExp("\\b"+b.replace(/[\\\[.+*?(){|^$]/g,"\\$\x26")+"\\b"):b,f.matchesonscroll=a.showMatchesOnScrollbar(b,!1,{className:"CodeMirror-selection-highlight-scrollbar"})}
function f(a){var b=a.state.matchHighlighter;b.overlay&&(a.removeOverlay(b.overlay),b.overlay=null,b.matchesonscroll&&(b.matchesonscroll.clear(),b.matchesonscroll=null))}function h(a){a.operation(function(){var c=a.state.matchHighlighter;if(f(a),!a.somethingSelected()&&c.options.showToken){for(var d=!0===c.options.showToken?/[\w$]/:c.options.showToken,e=a.getCursor(),g=a.getLine(e.line),h=e=e.ch;e&&d.test(g.charAt(e-1));)--e;for(;h<g.length&&d.test(g.charAt(h));)++h;return void(e<h&&b(a,g.slice(e,
h),d,c.options.style))}d=a.getCursor("from");g=a.getCursor("to");if((e=d.line==g.line)&&!(e=!c.options.wordsOnly))a:if(null!==a.getRange(d,g).match(/^\w+$/)){if(0<d.ch&&(e={line:d.line,ch:d.ch-1},e=a.getRange(e,d),null===e.match(/\W/))){e=!1;break a}if(g.ch<a.getLine(d.line).length&&(e={line:g.line,ch:g.ch+1},e=a.getRange(g,e),null===e.match(/\W/))){e=!1;break a}e=!0}else e=!1;e&&(d=a.getRange(d,g),c.options.trim&&(d=d.replace(/^\s+|\s+$/g,"")),d.length>=c.options.minChars&&b(a,d,!1,c.options.style))})}
function r(a,b,c){return{token:function(e){var f;if(f=e.match(a))(f=!b)||(f=!(e.start&&b.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&b.test(e.string.charAt(e.pos))));if(f)return c;e.next();e.skipTo(a.charAt(0))||e.skipToEnd()}}}var q={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};a.defineOption("highlightSelectionMatches",!1,function(b,c,d){if(d&&d!=a.Init&&(f(b),clearTimeout(b.state.matchHighlighter.timeout),b.state.matchHighlighter=
null,b.off("cursorActivity",n),b.off("focus",g)),c)c=b.state.matchHighlighter=new m(c),b.hasFocus()?(c.active=!0,h(b)):b.on("focus",g),b.on("cursorActivity",n)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/mode/multiplex.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.multiplexingMode=function(m){function n(a,b,f,g){return"string"==typeof b?(f=a.indexOf(b,f),g&&-1<f?f+b.length:f):(b=b.exec(f?a.slice(f):a))?b.index+f+(g?b[0].length:0):-1}var g=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:a.startState(m),
innerActive:null,inner:null}},copyState:function(c){return{outer:a.copyState(m,c.outer),innerActive:c.innerActive,inner:c.innerActive&&a.copyState(c.innerActive.mode,c.inner)}},token:function(c,b){if(b.innerActive){var f=b.innerActive,h=c.string;if(!f.close&&c.sol())return b.innerActive=b.inner=null,this.token(c,b);var r=f.close?n(h,f.close,c.pos,f.parseDelimiters):-1;if(r==c.pos&&!f.parseDelimiters)return c.match(f.close),b.innerActive=b.inner=null,f.delimStyle&&f.delimStyle+" "+f.delimStyle+"-close";
-1<r&&(c.string=h.slice(0,r));var q=f.mode.token(c,b.inner);return-1<r&&(c.string=h),r==c.pos&&f.parseDelimiters&&(b.innerActive=b.inner=null),f.innerStyle&&(q=q?q+" "+f.innerStyle:f.innerStyle),q}for(var q=1/0,h=c.string,p=0;p<g.length;++p){f=g[p];r=n(h,f.open,c.pos);if(r==c.pos)return f.parseDelimiters||c.match(f.open),b.innerActive=f,h=0,m.indent&&(r=m.indent(b.outer,""),r!==a.Pass&&(h=r)),b.inner=a.startState(f.mode,h),f.delimStyle&&f.delimStyle+" "+f.delimStyle+"-open";-1!=r&&r<q&&(q=r)}q!=1/
0&&(c.string=h.slice(0,q));r=m.token(c,b.outer);return q!=1/0&&(c.string=h),r},indent:function(c,b){var f=c.innerActive?c.innerActive.mode:m;return f.indent?f.indent(c.innerActive?c.inner:c.outer,b):a.Pass},blankLine:function(c){var b=c.innerActive?c.innerActive.mode:m;if(b.blankLine&&b.blankLine(c.innerActive?c.inner:c.outer),c.innerActive)"\n"===c.innerActive.close&&(c.innerActive=c.inner=null);else for(var f=0;f<g.length;++f){var h=g[f];"\n"===h.open&&(c.innerActive=h,c.inner=a.startState(h.mode,
b.indent?b.indent(c.outer,""):0))}},electricChars:m.electricChars,innerMode:function(a){return a.inner?{state:a.inner,mode:a.innerActive.mode}:{state:a.outer,mode:m}}}}});
(function(a){"function"==typeof a.define&&a.define("addons","addon/comment/continuecomment.js addon/edit/closebrackets.js addon/edit/closetag.js addon/edit/matchbrackets.js addon/edit/matchtags.js addon/edit/trailingspace.js addon/fold/foldgutter.js addon/fold/brace-fold.js addon/fold/comment-fold.js addon/fold/indent-fold.js addon/format/autoFormatAll.js addon/format/formatting.js addon/selection/active-line.js addon/search/match-highlighter.js addon/mode/multiplex.js".split(" "),function(){})})(this);
