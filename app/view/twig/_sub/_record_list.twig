{% macro record_list(contenttype, multiplecontent, permissions, extra_classes, async, filter) %}
    {% set async = async|default(false) %}
    {% set lastgroup = "----" %}
    {% set any_deletable = false %}
    {% set any_editable = false %}
    {% set includes = [
        '@bolt/custom/listing/' ~ contenttype.slug ~ '.twig',
        '@bolt/_sub/_listing.twig']
    %}

    {% if not async %}
        {{ data('recordlisting.confirm.one',      __('Are you sure you want to do this for 1 record?')) }}
        {{ data('recordlisting.confirm.multi',    __('Are you sure you want to do this for %NUMBER% records?')) }}
        {{ data('recordlisting.confirm.no-undo',  __('There is no undo!')) }}
        {{ data('recordlisting.action.cancel',    __('Cancel')) }}
        {{ data('recordlisting.action.delete',    __('contenttypes.generic.delete', {'%contenttype%': contenttype.slug})) }}
        {{ data('recordlisting.action.publish',   __('contenttypes.generic.publish', {'%contenttype%': contenttype.slug})) }}
        {{ data('recordlisting.action.depublish', __("Change status to 'held'")) }}
        {{ data('recordlisting.action.draft',     __("Change status to 'draft'")) }}
    {% endif %}

    {% set selection_toolbar %}
        <button type="button" data-stb-cmd="record:delete" class="danger separator"><i class="fa fa-trash"></i> {{ __('Delete') }}</button>
        <button type="button" data-stb-cmd="record:publish"><i class="fa fa-circle status-published"></i> {{ __('Publish') }}</button>
        <button type="button" data-stb-cmd="record:depublish"><i class="fa fa-circle status-held"></i> {{ __('Depublish') }}</button>
        <button type="button" data-stb-cmd="record:draft"><i class="fa fa-circle status-draft"></i> {{ __('Draft') }}</button>
    {% endset %}

    {% if not async %}
        <div class="buic-listing" data-bolt-widget="buicListing" data-contenttype="{{ contenttype.slug }}" data-bolt_csrf_token="{{ token() }}">
    {% endif %}
        <table class="{{ extra_classes }} dashboardlisting listing">
            {% for content in multiplecontent %}
                {% set editable = permissions.edit %}
                {% if editable %}
                    {% set any_editable = true %}
                {% endif %}
                {% set deletable = permissions.delete %}
                {% if deletable %}
                    {% set any_deletable = true %}
                {% endif %}

                {% set new_group = content.group.name is defined and (loop.first or content.group.name != lastgroup) %}

                {% set listing_vars = {
                    'compact':       false,
                    'content':       content,
                    'excerptlength': 380,
                    'permissions':   permissions,
                    'thumbsize':     80,
                    'internal': {
                        'selection_toolbar': selection_toolbar
                    },
                    'filter':        filter
                } %}
                {% include includes with listing_vars %}

                {% if content.group.name is defined and (loop.first or content.group.name != lastgroup) %}
                    {% set lastgroup = content.group.name %}
                {% endif %}
            {% else %}
                {{ __('contenttypes.generic.none-available', {'%contenttypes%': contenttype.slug}) }}
            {% endfor %}
        </table>

        {% from '@bolt/_macro/_pager.twig' import pager %}
        {{ pager(contenttype.slug) }}
    {% if not async %}
        </div>
    {% endif %}

{% endmacro %}
