(function(){function k(a,b,c){var d;return d=a.getWrapperElement().appendChild(document.createElement("div")),d.className=c?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof b?d.innerHTML=b:d.appendChild(b),d}function j(a,b){a.state.currentNotificationClose&&a.state.currentNotificationClose();a.state.currentNotificationClose=b}CodeMirror.defineExtension("openDialog",function(a,b,c){function d(){h||(h=!0,g.parentNode.removeChild(g))}var f;j(this,
null);var g=k(this,a,c&&c.bottom),h=!1,o=this;if(f=g.getElementsByTagName("input")[0],f){CodeMirror.on(f,"keydown",function(a){c&&c.onKeyDown&&c.onKeyDown(a,f.value,d)||(13==a.keyCode||27==a.keyCode)&&(CodeMirror.e_stop(a),d(),o.focus(),13==a.keyCode&&b(f.value))});if(c&&c.onKeyUp)CodeMirror.on(f,"keyup",function(a){c.onKeyUp(a,f.value,d)});c&&c.value&&(f.value=c.value);f.focus();CodeMirror.on(f,"blur",d)}else if(a=g.getElementsByTagName("button")[0])CodeMirror.on(a,"click",function(){d();o.focus()}),
a.focus(),CodeMirror.on(a,"blur",d);return d});CodeMirror.defineExtension("openConfirm",function(a,b,c){function d(){h||(h=!0,g.parentNode.removeChild(g),o.focus())}var f;j(this,null);var g=k(this,a,c&&c.bottom),c=g.getElementsByTagName("button"),h=!1,o=this,p=1;c[0].focus();for(a=0;a<c.length;++a)f=c[a],function(a){CodeMirror.on(f,"click",function(b){CodeMirror.e_preventDefault(b);d();a&&a(o)})}(b[a]),CodeMirror.on(f,"blur",function(){--p;setTimeout(function(){0>=p&&d()},200)}),CodeMirror.on(f,"focus",
function(){++p})});CodeMirror.defineExtension("openNotification",function(a,b){function c(){g||(g=!0,clearTimeout(h),d.parentNode.removeChild(d))}j(this,c);var d=k(this,a,b&&b.bottom),f=b&&(void 0===b.duration?5E3:b.duration),g=!1,h;CodeMirror.on(d,"click",function(a){CodeMirror.e_preventDefault(a);c()});f&&(h=setTimeout(c,b.duration))})})();
(function(){function k(n){return"string"==typeof n?{token:function(a){if(a.match(n))return"searching";a.next();a.skipTo(n.charAt(0))||a.skipToEnd()}}:{token:function(a){if(a.match(n))return"searching";for(;!a.eol()&&!(a.next(),a.match(n,!1)););}}}function j(){this.overlay=this.posFrom=this.posTo=this.query=null}function a(a){return a.state.search||(a.state.search=new j)}function b(a,b,c){return a.getSearchCursor(b,c,"string"==typeof b&&b==b.toLowerCase())}function c(a,b,c,d){a.openDialog?a.openDialog(b,
d):d(prompt(c,""))}function d(a,b,c,d){a.openConfirm?a.openConfirm(b,d):confirm(c)&&d[0]()}function f(a){var b=a.match(/^\/(.*)\/([a-z]*)$/);return b?RegExp(b[1],-1==b[2].indexOf("i")?"":"i"):a}function g(b,d){var e=a(b);if(e.query)return h(b,d);c(b,l,"Search for:",function(a){b.operation(function(){a&&!e.query&&(e.query=f(a),b.removeOverlay(e.overlay),e.overlay=k(e.query),b.addOverlay(e.overlay),e.posFrom=e.posTo=b.getCursor(),h(b,d))})})}function h(c,d){c.operation(function(){var e=a(c),h=b(c,e.query,
d?e.posFrom:e.posTo);(h.find(d)||(h=b(c,e.query,d?CodeMirror.Pos(c.lastLine()):CodeMirror.Pos(c.firstLine(),0)),h.find(d)))&&(c.setSelection(h.from(),h.to()),c.scrollIntoView({from:h.from(),to:h.to()}),e.posFrom=h.from(),e.posTo=h.to())})}function o(b){b.operation(function(){var c=a(b);c.query&&(c.query=null,b.removeOverlay(c.overlay))})}function p(a,h){c(a,e,"Replace:",function(e){e&&(e=f(e),c(a,i,"Replace with:",function(c){if(h)a.operation(function(){for(var d,h=b(a,e);h.findNext();)"string"!=
typeof e?(d=a.getRange(h.from(),h.to()).match(e),h.replace(c.replace(/\$(\d)/,function(a,b){return d[b]}))):h.replace(c)});else{o(a);var f=b(a,e,a.getCursor()),g=function(){var c=f.from(),h;((h=f.findNext())||(f=b(a,e),(h=f.findNext())&&(!c||f.from().line!=c.line||f.from().ch!=c.ch)))&&(a.setSelection(f.from(),f.to()),a.scrollIntoView({from:f.from(),to:f.to()}),d(a,m,"Replace?",[function(){p(h)},g]))},p=function(a){f.replace("string"==typeof e?c:c.replace(/\$(\d)/,function(b,c){return a[c]}));g()};
g()}}))})}var l='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',e='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',i='With: <input type="text" style="width: 10em"/>',m="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(a){o(a);g(a)};CodeMirror.commands.findNext=g;CodeMirror.commands.findPrev=function(a){g(a,
!0)};CodeMirror.commands.clearSearch=o;CodeMirror.commands.replace=p;CodeMirror.commands.replaceAll=function(a){p(a,!0)}})();
(function(){function k(a,b,c,d){if(this.atOccurrence=!1,this.doc=a,null==d&&"string"==typeof b&&(d=!1),c=c?a.clipPos(c):j(0,0),this.pos={from:c,to:c},"string"!=typeof b)b.global||(b=RegExp(b.source,b.ignoreCase?"ig":"g")),this.matches=function(c,d){var f,g,e,i,m;if(c){b.lastIndex=0;f=a.getLine(d.line).slice(0,d.ch);for(g=0;!(b.lastIndex=g,m=b.exec(f),!m)&&!(e=m,i=e.index,g=e.index+(e[0].length||1),g==f.length););(g=e&&e[0].length||0)||(0==i&&0==f.length?e=void 0:i!=a.getLine(d.line).length&&g++)}else b.lastIndex=
d.ch,f=a.getLine(d.line),g=(e=b.exec(f))&&e[0].length||0,i=e&&e.index,i+g==f.length||g||(g=1);if(e&&g)return{from:j(d.line,i),to:j(d.line,i+g),match:e}};else{d&&(b=b.toLowerCase());var f=d?function(a){return a.toLowerCase()}:function(a){return a},g=b.split("\n");this.matches=1==g.length?b.length?function(c,d){var g=f(a.getLine(d.line)),l=b.length,e;if(c?d.ch>=l&&-1!=(e=g.lastIndexOf(b,d.ch-l)):-1!=(e=g.indexOf(b,d.ch)))return{from:j(d.line,e),to:j(d.line,e+l)}}:function(){}:function(b,c){var d=c.line,
l=b?g.length-1:0,e=g[l],i=f(a.getLine(d)),m=b?i.indexOf(e)+e.length:i.lastIndexOf(e),n,k,q;if(!(b?m>c.ch||m!=e.length:m<c.ch||m!=i.length-e.length))for(;!(b?!d:d==a.lineCount()-1);)if(i=f(a.getLine(d+=b?-1:1)),e=g[b?--l:++l],0<l&&l<g.length-1){if(i!=e)break}else return(n=b?i.lastIndexOf(e):i.indexOf(e)+e.length,b?n!=i.length-e.length:n!=e.length)?void 0:(k=j(c.line,m),q=j(d,n),{from:b?q:k,to:b?k:q})}}}var j=CodeMirror.Pos;k.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},
find:function(a){function b(a){a=j(a,0);return c.pos={from:a,to:a},c.atOccurrence=!1,!1}for(var c=this,d=this.doc.clipPos(a?this.pos.from:this.pos.to),f;;){if(this.pos=this.matches(a,d))return this.pos.from&&this.pos.to||console.log(this.matches,this.pos),this.atOccurrence=!0,this.pos.match||!0;if(a){if(!d.line)return b(0);d=j(d.line-1,this.doc.getLine(d.line-1).length)}else{if(f=this.doc.lineCount(),d.line==f-1)return b(f);d=j(d.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},
to:function(){if(this.atOccurrence)return this.pos.to},replace:function(a){this.atOccurrence&&(a=CodeMirror.splitLines(a),this.doc.replaceRange(a,this.pos.from,this.pos.to),this.pos.to=j(this.pos.from.line+a.length-1,a[a.length-1].length+(1==a.length?this.pos.from.ch:0)))}};CodeMirror.defineExtension("getSearchCursor",function(a,b,c){return new k(this.doc,a,b,c)});CodeMirror.defineDocExtension("getSearchCursor",function(a,b,c){return new k(this,a,b,c)})})();