(function(){function l(i,d,a){var g;return g=i.getWrapperElement().appendChild(document.createElement("div")),g.className=a?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top",g.innerHTML=d,g}CodeMirror.defineExtension("openDialog",function(i,d,a){function g(){k||(k=!0,e.parentNode.removeChild(e))}var e=l(this,i,a&&a.bottom),k=!1,j=this,c=e.getElementsByTagName("input")[0];if(c){CodeMirror.on(c,"keydown",function(f){a&&a.onKeyDown&&a.onKeyDown(f,c.value,g)||(13==
f.keyCode||27==f.keyCode)&&(CodeMirror.e_stop(f),g(),j.focus(),13==f.keyCode&&d(c.value))});if(a&&a.onKeyUp)CodeMirror.on(c,"keyup",function(d){a.onKeyUp(d,c.value,g)});a&&a.value&&(c.value=a.value);c.focus();CodeMirror.on(c,"blur",g)}else if(i=e.getElementsByTagName("button")[0])CodeMirror.on(i,"click",function(){g();j.focus()}),i.focus(),CodeMirror.on(i,"blur",g);return g});CodeMirror.defineExtension("openConfirm",function(i,d,a){function g(){k||(k=!0,e.parentNode.removeChild(e),j.focus())}var e=
l(this,i,a&&a.bottom),i=e.getElementsByTagName("button"),k=!1,j=this,c=1,f;i[0].focus();for(a=0;a<i.length;++a)f=i[a],function(a){CodeMirror.on(f,"click",function(d){CodeMirror.e_preventDefault(d);g();a&&a(j)})}(d[a]),CodeMirror.on(f,"blur",function(){--c;setTimeout(function(){0>=c&&g()},200)}),CodeMirror.on(f,"focus",function(){++c})})})();
(function(){function l(h){return"string"==typeof h?{token:function(a){if(a.match(h))return"searching";a.next();a.skipTo(h.charAt(0))||a.skipToEnd()}}:{token:function(a){if(a.match(h))return"searching";for(;!a.eol()&&!(a.next(),a.match(h,!1)););}}}function i(){this.overlay=this.posFrom=this.posTo=this.query=null}function d(h,a,d){return h.getSearchCursor(a,d,"string"==typeof a&&a==a.toLowerCase())}function a(h,a,d,c){h.openDialog?h.openDialog(a,c):c(prompt(d,""))}function g(a,d,c,f){a.openConfirm?
a.openConfirm(d,f):confirm(c)&&f[0]()}function e(a){var d=a.match(/^\/(.*)\/([a-z]*)$/);return d?RegExp(d[1],-1==d[2].indexOf("i")?"":"i"):a}function k(h,d){var c=h._searchState||(h._searchState=new i);if(c.query)return j(h,d);a(h,p,"Search for:",function(a){h.operation(function(){a&&!c.query&&(c.query=e(a),h.removeOverlay(c.overlay),c.overlay=l(a),h.addOverlay(c.overlay),c.posFrom=c.posTo=h.getCursor(),j(h,d))})})}function j(a,c){a.operation(function(){var f=a._searchState||(a._searchState=new i),
b=d(a,f.query,c?f.posFrom:f.posTo);(b.find(c)||(b=d(a,f.query,c?CodeMirror.Pos(a.lastLine()):CodeMirror.Pos(a.firstLine(),0)),b.find(c)))&&(a.setSelection(b.from(),b.to()),f.posFrom=b.from(),f.posTo=b.to())})}function c(a){a.operation(function(){var c=a._searchState||(a._searchState=new i);c.query&&(c.query=null,a.removeOverlay(c.overlay))})}function f(h,f){a(h,q,"Replace:",function(i){i&&(i=e(i),a(h,b,"Replace with:",function(a){if(f)h.operation(function(){for(var c,b=d(h,i);b.findNext();)"string"!=
typeof i?(c=h.getRange(b.from(),b.to()).match(i),b.replace(a.replace(/\$(\d)/,function(a,b){return c[b]}))):b.replace(a)});else{c(h);var b=d(h,i,h.getCursor()),e=function(){var a=b.from(),c;((c=b.findNext())||(b=d(h,i),(c=b.findNext())&&(!a||b.from().line!=a.line||b.from().ch!=a.ch)))&&(h.setSelection(b.from(),b.to()),g(h,m,"Replace?",[function(){j(c)},e]))},j=function(c){b.replace("string"==typeof i?a:a.replace(/\$(\d)/,function(a,b){return c[b]}));e()};e()}}))})}var p='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',
q='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',b='With: <input type="text" style="width: 10em"/>',m="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(a){c(a);k(a)};CodeMirror.commands.findNext=k;CodeMirror.commands.findPrev=function(a){k(a,!0)};CodeMirror.commands.clearSearch=c;CodeMirror.commands.replace=f;CodeMirror.commands.replaceAll=function(a){f(a,!0)}})();
(function(){function l(d,a,g,e){if(this.atOccurrence=!1,this.cm=d,null==e&&"string"==typeof a&&(e=!1),g=g?d.clipPos(g):i(0,0),this.pos={from:g,to:g},"string"!=typeof a)a.global||(a=RegExp(a.source,a.ignoreCase?"ig":"g")),this.matches=function(c,f){var e,g,b,j,h;if(c){a.lastIndex=0;e=d.getLine(f.line).slice(0,f.ch);for(g=0;!(a.lastIndex=g,h=a.exec(e),!h);)b=h,j=b.index,g=b.index+1}else a.lastIndex=f.ch,e=d.getLine(f.line),j=(b=a.exec(e))&&b.index;if(b&&b[0])return{from:i(f.line,j),to:i(f.line,j+b[0].length),
match:b}};else{e&&(a=a.toLowerCase());var k=e?function(a){return a.toLowerCase()}:function(a){return a},j=a.split("\n");this.matches=1==j.length?a.length?function(c,f){var e=k(d.getLine(f.line)),g=a.length,b;if(c?f.ch>=g&&-1!=(b=e.lastIndexOf(a,f.ch-g)):-1!=(b=e.indexOf(a,f.ch)))return{from:i(f.line,b),to:i(f.line,b+g)}}:function(){}:function(a,f){var e=f.line,g=a?j.length-1:0,b=j[g],m=k(d.getLine(e)),h=a?m.indexOf(b)+b.length:m.lastIndexOf(b),l,n,o;if(!(a?h>=f.ch||h!=b.length:h<=f.ch||h!=m.length-
b.length))for(;!(a?!e:e==d.lineCount()-1);)if(m=k(d.getLine(e+=a?-1:1)),b=j[a?--g:++g],0<g&&g<j.length-1){if(m!=b)break}else return(l=a?m.lastIndexOf(b):m.indexOf(b)+b.length,a?l!=m.length-b.length:l!=b.length)?void 0:(n=i(f.line,h),o=i(e,l),{from:a?o:n,to:a?n:o})}}}var i=CodeMirror.Pos;l.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(d){function a(a){a=i(a,0);return g.pos={from:a,to:a},g.atOccurrence=!1,!1}for(var g=this,e=this.cm.clipPos(d?
this.pos.from:this.pos.to),k;;){if(this.pos=this.matches(d,e))return this.pos.from&&this.pos.to||console.log(this.matches,this.pos),this.atOccurrence=!0,this.pos.match||!0;if(d){if(!e.line)return a(0);e=i(e.line-1,this.cm.getLine(e.line-1).length)}else{if(k=this.cm.lineCount(),e.line==k-1)return a(k);e=i(e.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(d){this.atOccurrence&&(d=CodeMirror.splitLines(d),
this.cm.replaceRange(d,this.pos.from,this.pos.to),this.pos.to=i(this.pos.from.line+d.length-1,d[d.length-1].length+(1==d.length?this.pos.from.ch:0)))}};CodeMirror.defineExtension("getSearchCursor",function(d,a,g){return new l(this,d,a,g)})})();