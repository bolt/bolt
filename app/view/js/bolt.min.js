/**
 * These are Bolt's COMPILED JS files!
 * You can edit files in <js/src/*.js> and run 'grunt' to generate this file.
 */
function getSelectedItems(){var a=[];return $(".dashboardlisting input:checked").each(function(){$(this).parents("tr").attr("id")&&a.push($(this).parents("tr").attr("id").substr(5))}),console.log("getSelectedItems: "+a),a}function LegacyValidation(a){var b=!0,c=a.value,d=a.getAttribute("type"),e="checkbox"===d||"radio"===d,f=a.getAttribute("required"),g=a.getAttribute("minlength"),h=a.getAttribute("maxlength"),i=a.getAttribute("pattern");return a.disabled?b:(b=b&&(!f||e&&a.checked||!e&&""!==c),b=b&&(e||(!g||c.length>=g)&&(!h||c.length<=h)),b&&i&&(i=new RegExp("^(?:"+i+")$"),b=i.test(c)),b)}function validateContent(a){var b,c,d=a.elements.length,e=!0;for(b=0;d>b;b++)if(c=a.elements[b],"INPUT"===c.nodeName||"TEXTAREA"===c.nodeName||"SELECT"===c.nodeName){"INPUT"===c.nodeName&&(c.value=c.value.trim()),"undefined"!=typeof c.willValidate?("INPUT"===c.nodeName&&c.type!==c.getAttribute("type")&&c.setCustomValidity(LegacyValidation(c)?"":"error"),c.checkValidity()):(c.validity=c.validity||{},c.validity.valid=LegacyValidation(c));var f=c.id+"-notice";if($("#"+f).remove(),c.validity.valid)$(c).removeClass("error");else{$(c).addClass("error");var g=$(c).data("errortext")||"The "+c.name+" field is required or needs to match a pattern";$('<div id="'+f+'" class="alert alert-danger"><button class="close" data-dismiss="alert">×</button>'+g+"</div>").hide().insertAfter(".page-header").slideDown("fast"),e=!1}}return e}function updateLatestActivity(){$.get(bolt.paths.async+"latestactivity",function(a){$("#latesttemp").html(a),bolt.moments.update(),$("#latestactivity").html($("#latesttemp").html())}),setTimeout(function(){updateLatestActivity()},3e4)}function bindFileUpload(a){$("#fileupload-"+a).fileupload({dataType:"json",dropZone:$("#dropzone-"+a),done:function(b,c){$.each(c.result,function(b,c){var d,e;void 0===c.error?(d=decodeURI(c.url).replace("files/",""),$("#field-"+a).val(d),$("#thumbnail-"+a).html('<img src="'+bolt.paths.root+"thumbs/200x150c/"+encodeURI(d)+'" width="200" height="150">'),window.setTimeout(function(){$("#progress-"+a).fadeOut("slow")},1500),bolt.stack.addToStack(d)):(e="Oops! There was an error uploading the file. Make sure the file is not corrupt, and that the 'files/'-folder is writable.\n\n(error was: "+c.error+")",alert(e),window.setTimeout(function(){$("#progress-"+a).fadeOut("slow")},50)),$("#progress-"+a+" div.bar").css("width","100%"),$("#progress-"+a).removeClass("progress-striped active")})}}).bind("fileuploadprogress",function(b,c){var d=Math.round(100*c._bitrateTimer.loaded/c.files[0].size);$("#progress-"+a).show().addClass("progress-striped active"),$("#progress-"+a+" div.bar").css("width",d+"%")})}function makeUriAjax(a,b,c,d,e){$.ajax({url:bolt.paths.async+"makeuri",type:"GET",data:{title:a,contenttypeslug:b,id:c,fulluri:e},success:function(a){$("#"+d).val(a),$("#show-"+d).html(a)},error:function(){console.log("failed to get an URI")}})}function makeUri(a,b,c,d,e){$(c).each(function(){$("#"+this).on("propertychange.bolt input.bolt change.bolt",function(){var f="";$(c).each(function(){f+=$("#"+this).is("select")&&$("#"+this).hasClass("slug-text")?$("#"+this).val()?$("#"+this).find("option[value="+$("#"+this).val()+"]").text():"":$("#"+this).val()||"",f+=" "}),clearTimeout(makeuritimeout),makeuritimeout=setTimeout(function(){makeUriAjax(f,a,b,d,e)},200)}).trigger("change.bolt")})}function stopMakeUri(a){$(a).each(function(){$("#"+this).unbind("propertychange.bolt input.bolt change.bolt")}),clearTimeout(makeuritimeout)}function bindVideoEmbedAjax(a){var b="http://api.embed.ly/1/oembed?format=json&key=51fa004148ad4d05b115940be9dd3c7e&url=",c=$("#video-"+a).val(),d=b+encodeURI(c);return c.length<2?($("#video-"+a+"-html").val(""),$("#video-"+a+"-width").val(""),$("#video-"+a+"-height").val(""),$("#video-"+a+"-ratio").val(""),$("#video-"+a+"-text").html(""),$("#myModal").find(".modal-body").html(""),$("#video-"+a+"-author_name").val(""),$("#video-"+a+"-author_url").val(""),$("#video-"+a+"-title").val(""),$("#thumbnail-"+a).html(""),void $("#video-"+a+"-thumbnail").val("")):void $.getJSON(d,function(b){b.html&&($("#video-"+a+"-html").val(b.html),$("#video-"+a+"-width").val(b.width),$("#video-"+a+"-height").val(b.height),$("#video-"+a+"-ratio").val(b.width/b.height),$("#video-"+a+"-text").html('"<b>'+b.title+'</b>" by '+b.author_name),$("#myModal").find(".modal-body").html(b.html),$("#video-"+a+"-author_name").val(b.author_name),$("#video-"+a+"-author_url").val(b.author_url),$("#video-"+a+"-title").val(b.title)),b.thumbnail_url&&($("#thumbnail-"+a).html('<img src="'+b.thumbnail_url+'" width="200" height="150">'),$("#video-"+a+"-thumbnail").val(b.thumbnail_url))})}function bindVideoEmbed(a){$("#video-"+a).bind("propertychange input",function(){clearTimeout(videoembedtimeout),videoembedtimeout=setTimeout(function(){bindVideoEmbedAjax(a)},400)}),$("#video-"+a+"-width").bind("propertychange input",function(){$("#video-"+a+"-ratio").val()>0&&$("#video-"+a+"-height").val(Math.round($("#video-"+a+"-width").val()/$("#video-"+a+"-ratio").val()))}),$("#video-"+a+"-height").bind("propertychange input",function(){$("#video-"+a+"-ratio").val()>0&&$("#video-"+a+"-width").val(Math.round($("#video-"+a+"-height").val()*$("#video-"+a+"-ratio").val()))})}function updateGeoCoords(a){var b,c,d,e=$.goMap.getMarkers();"undefined"!=typeof e[0]&&(b=e[0].split(","),"undefined"!=typeof b[0]&&"undefined"!=typeof b[1]&&($("#"+a+"-latitude").val(b[0]),$("#"+a+"-longitude").val(b[1]),c=new google.maps.Geocoder,d=new google.maps.LatLng(b[0],b[1]),c.geocode({latLng:d},function(b){$("#"+a+"-reversegeo").html(b[0].formatted_address),$("#"+a+"-formatted_address").val(b[0].formatted_address)})))}function bindGeoAjax(a){var b=$("#"+a+"-address").val();return b.length<2?($("#"+a+"-latitude").val(""),$("#"+a+"-longitude").val(""),$("#"+a+"-reversegeo").html(""),void $("#"+a+"-formatted_address").val("")):($.goMap.setMap({address:b}),$.goMap.setMarker("pinmarker",{address:b}),void setTimeout(function(){updateGeoCoords(a)},500))}function bindGeolocation(a,b,c){b=parseFloat(b),c=parseFloat(c),(0===b||isNaN(b))&&(b=52.08184),(0===c||isNaN(c))&&(c=4.292368),$("#"+a+"-address").bind("propertychange input",function(){clearTimeout(geotimeout),geotimeout=setTimeout(function(){bindGeoAjax(a)},800)}),$("#map-"+a).goMap({latitude:b,longitude:c,zoom:15,maptype:"ROADMAP",disableDoubleClickZoom:!0,addMarker:!1,icon:bolt.paths.app+"view/img/pin_red.png",markers:[{latitude:b,longitude:c,id:"pinmarker",title:"Pin",draggable:!0}]}),$.goMap.createListener({type:"marker",marker:"pinmarker"},"mouseup",function(){updateGeoCoords(a)})}var bolt={};try{console.assert(1)}catch(e){console={log:function(){},assert:function(){}}}var makeuritimeout,videoembedtimeout,geotimeout,FileModel=Backbone.Model.extend({defaults:{id:null,filename:null,title:"Untitled",order:1},initialize:function(){}}),Filelist=Backbone.Collection.extend({model:FileModel,comparator:function(a){return a.get("order")},setOrder:function(a,b,c){_.each(this.models,function(d){d.get("id")===a&&(d.set("order",b),d.set("title",c))})}}),FilelistHolder=Backbone.View.extend({initialize:function(a){this.list=new Filelist,this.type=a.type,this.idPrefix="ImageList"==a.type?"#imagelist-":"#filelist-";var b=$("#"+this.id).val();""!==b&&(b=$.parseJSON($("#"+this.id).val()),_.each(b,function(a){this.list.add(new FileModel({filename:a.filename,title:a.title,id:this.list.length}))},this)),this.render(),this.bindEvents()},render:function(){this.list.sort();var a=$(this.idPrefix+this.id+" .list"),b=a.data("list"),c=this.type;a.html(""),_.each(this.list.models,function(d){var e=$(b.item.replace(/<ID>/g,d.get("id")).replace(/<VAL>/g,_.escape(d.get("title"))).replace(/<PATH>/g,bolt.paths.bolt).replace(/<FNAME>/g,d.get("filename")));"ImageList"===c&&e.find(".thumbnail-link").magnificPopup({type:"image"}),a.append(e)}),0===this.list.models.length&&a.append(b.empty),this.serialize()},add:function(a,b){this.list.add(new FileModel({filename:a,title:b,id:this.list.length})),this.render()},remove:function(a,b){var c=!1;_.each(this.list.models,function(b){c||b.get("id")!==a||(this.list.remove(b),c=!0)},this),b||this.render()},serialize:function(){var a=JSON.stringify(this.list);$("#"+this.id).val(a)},doneSort:function(){var a=this.list;$(this.idPrefix+this.id+" .list div").each(function(b){var c=$(this).data("id"),d=$(this).find("input").val();a.setOrder(c,b,d)}),this.render()},bindEvents:function(){var a=this,b=this.id,c=$(this.idPrefix+this.id);c.find("div.list").sortable({helper:function(a,b){return b.hasClass("selected")||b.toggleClass("selected"),$("<div></div>")},start:function(a,b){var d=c.find(".selected").not(".ui-sortable-placeholder"),e=d.length,f=b.placeholder.outerHeight(!0),g=b.placeholder.height(),h=parseInt(b.placeholder.css("margin-top"))+parseInt(b.placeholder.css("margin-bottom"));d.css("display","none"),b.placeholder.height(g+e*f-f-h),b.item.data("items",d)},beforeStop:function(a,b){b.item.before(b.item.data("items"))},stop:function(){c.find(".ui-state-active").css("display",""),a.doneSort()},delay:100,distance:5}),$("#fileupload-"+b).fileupload({dataType:"json",dropZone:c,pasteZone:null,done:function(b,c){$.each(c.result,function(b,c){var d=decodeURI(c.url).replace("files/","");a.add(d,d)})}}).bind("fileuploadsubmit",function(a,c){var d,e=$("#fileupload-"+b).attr("accept"),f=$(this.idPrefix+b+" div.list").data("list");"undefined"!=typeof e&&(d=new RegExp("\\.("+e.replace(/,/g,"|").replace(/\./g,"")+")$","i"),$.each(c.files,function(b,c){return d.test(c.name)?void 0:(alert(f.message.wrongtype),a.preventDefault(),!1)}))});var d=null;c.find("div.list").on("click",".list-item",function(a){if($(a.target).hasClass("list-item")){if(a.shiftKey){if(d){var b=$(this).index(),e=d.index();e>b?$(this).nextUntil(d).add(this).add(d).addClass("selected"):b>e?$(this).prevUntil(d).add(this).add(d).addClass("selected"):$(this).toggleClass("selected")}}else a.ctrlKey||a.metaKey?$(this).toggleClass("selected"):(c.find(".list-item").not($(this)).removeClass("selected"),$(this).toggleClass("selected"));d=a.shiftKey||a.ctrlKey||a.metaKey||$(this).hasClass("selected")?$(this):null}}),c.find(".remove-selected-button").on("click",function(){var b=c.find("div.list").data("list");confirm(b.message.removeMulti)&&(c.find(".selected").each(function(){a.remove($(this).data("id"),!0)}),a.render())}),c.find("div.list").on("click",".remove-button",function(b){var c=$(this).closest("div.list").data("list");b.preventDefault(),confirm(c.message.remove)&&a.remove($(this).parent().data("id"))}),c.find("div.list").on("blur","input",function(){a.doneSort()}),"ImageList"===this.type&&($("#selectImageModal-"+b).on("click",".folder",function(a){a.preventDefault(),$("#selectImageModal-"+b+" .modal-content").load($(this).data("action"))}),$("#selectImageModal-"+b).on("click",".file",function(b){b.preventDefault();var c=$(this).data("action");a.add(c,c)}))}}),Sidebar=Backbone.Model.extend({defaults:{},initialize:function(){window.setTimeout(function(){bolt.sidebar.fixlength()},500)},fixlength:function(){var a=$("#navpage-content").height()+34;a>$("#navpage-secondary").height()?($("#navpage-secondary").height(a+"px"),window.setTimeout(function(){bolt.sidebar.fixlength()},300)):window.setTimeout(function(){bolt.sidebar.fixlength()},3e3)},collapse:function(){$("#navpage-wrapper").removeClass("nav-secondary-opened").addClass("nav-secondary-collapsed"),setTimeout(function(){$("#navpage-wrapper").addClass("nav-secondary-collapsed-hoverable")},300),$.cookie("sidebar","collapsed",{expires:21,path:"/"})},expand:function(){$("#navpage-wrapper").removeClass("nav-secondary-collapsed nav-secondary-opened nav-secondary-collapsed-hoverable"),$.removeCookie("sidebar",{path:"/"})},toggle:function(){var a=$("#navpage-wrapper");a.hasClass("nav-secondary-opened")?a.removeClass("nav-secondary-opened nav-secondary-collapsed"):a.removeClass("nav-secondary-collapsed").addClass("nav-secondary-opened")}}),Navpopups=Backbone.Model.extend({defaults:{},initialize:function(){var a="";$("#navpage-secondary a.menu-pop").each(function(){var a="";$(this).nextAll(".submenu").children().each(function(){$(this).hasClass("subdivider")&&(a+="<hr>"),a+=$(this).html().trim().replace(/[ \n]+/g," ").replace(/(>) | (<)/g,"$1$2")}),$(this).attr("data-html",!0).attr("data-content",a)}),$(".navbar-toggle").is(":visible")?$("#navpage-secondary a.menu-pop").on("click",function(a){a.preventDefault();var b=$(this).nextAll(".submenu");b.hasClass("show")?b.removeClass("show"):($("#navpage-secondary .submenu").removeClass("show"),b.addClass("show"))}):$("#navpage-secondary").on("mouseover focus","a.menu-pop",function(){var b=this;window.clearTimeout(a),a=window.setTimeout(function(){$("#navpage-secondary a.menu-pop").not(b).popover("hide"),$(b).popover("show")},300)}).on("mouseenter focus",".popover",function(){window.clearTimeout(a)}).on("mouseleave blur","a.menu-pop, .popover",function(){window.clearTimeout(a),a=window.setTimeout(function(){$("#navpage-secondary a.menu-pop").popover("hide")},300)})}}),Moments=Backbone.Model.extend({defaults:{timeout:void 0,wait:16e3},initialize:function(){moment.locale(bolt.locale["long"]),$("time.moment").length&&this.update()},update:function(){var a,b=this;$("time.moment").each(function(){$(this).html(moment($(this).attr("datetime")).fromNow())}),clearTimeout(this.get("timeout")),a=setTimeout(function(){b.update()},this.get("wait")),this.set("timeout",a)}}),Files=Backbone.Model.extend({defaults:{},initialize:function(){},renameFile:function(a,b,c,d){var e=window.prompt(a,d);e.length&&$.ajax({url:bolt.paths.async+"renamefile",type:"POST",data:{namespace:b,parent:c,oldname:d,newname:e},success:function(){document.location.reload()},error:function(){console.log("Something went wrong renaming this file!")}})},deleteFile:function(a,b,c){confirm("Are you sure you want to delete "+b+"?")&&$.ajax({url:bolt.paths.async+"deletefile",type:"POST",data:{namespace:a,filename:b},success:function(){console.log("Deleted file "+b+" from the server"),null!==c&&$(c).closest("tr").slideUp()},error:function(){console.log("Failed to delete the file from the server")}})},duplicateFile:function(a,b){$.ajax({url:bolt.paths.async+"duplicatefile",type:"POST",data:{namespace:a,filename:b},success:function(){document.location.reload()},error:function(){console.log("Something went wrong duplicating this file!")}})}}),Stack=Backbone.Model.extend({defaults:{},initialize:function(){this.bindEvents()},bindEvents:function(){bindFileUpload("stack"),$("#selectImageModal-stack").on("click",".folder",function(a){a.preventDefault(),alert("hoi"),$("#selectImageModal-stack .modal-content").load($(this).attr("href"))})},addToStack:function(a,b){var c,d=a.substr(a.lastIndexOf(".")+1).toLowerCase();c="jpg"===d||"jpeg"===d||"png"===d||"gif"===d?"image":"other",a=a.replace(/files\//gi,""),$.ajax({url:bolt.paths.async+"addstack/"+a,type:"GET",success:function(){console.log("Added file "+a+" to stack");var e,f,g,h,i=$("#stackholder div.stackitem");for(e=i.length;e>=1;e--)f=e+1,g=$("#stackholder div.stackitem.item-"+e),g.addClass("item-"+f).removeClass("item-"+e);$("#stackholder div.stackitem.item-8").is("*")&&$("#stackholder div.stackitem.item-8").remove(),null!==b&&$(b).addClass("disabled"),"image"===c?(h=$("#protostack div.image").clone(),$(h).find("img").attr("src",bolt.paths.bolt+"../thumbs/100x100c/"+encodeURI(a))):(h=$("#protostack div.other").clone(),$(h).find("strong").html(d.toUpperCase()),$(h).find("small").html(a)),$("#stackholder").prepend(h),$(".nostackitems").remove()},error:function(){console.log("Failed to add file to stack")}})},selectFromPulldown:function(a,b){if(console.log("select: ",a+" = "+b),$("#field-"+a).is("*")&&$("#field-"+a).val(b),"object"==typeof bolt.imagelist&&"object"==typeof bolt.imagelist[a]&&bolt.imagelist[a].add(b,b),"object"==typeof bolt.filelist&&"object"==typeof bolt.filelist[a]&&bolt.filelist[a].add(b,b),$("#thumbnail-"+a).is("*")){var c=bolt.paths.bolt+"../thumbs/200x150c/"+encodeURI(b);$("#thumbnail-"+a).html('<img src="'+c+'" width="200" height="150">')}$("#selectModal-"+a).is("*")&&$("#selectModal-"+a).modal("hide"),"stack"===a&&bolt.stack.addToStack(b),$(".in,.open").removeClass("in open")},changeFolder:function(a,b){$("#selectModal-"+a+" .modal-content").load(b)}}),Folders=Backbone.Model.extend({defaults:{},initialize:function(){},create:function(a,b,c){var d=window.prompt(a);d.length&&$.ajax({url:bolt.paths.async+"folder/create",type:"POST",data:{parent:c,foldername:d,namespace:b},success:function(){document.location.reload()},error:function(){console.log("Something went wrong renaming this folder!")}})},rename:function(a,b,c,d){var e=window.prompt(a,d);e.length&&$.ajax({url:bolt.paths.async+"folder/rename",type:"POST",data:{namespace:b,parent:c,oldname:d,newname:e},success:function(){document.location.reload()},error:function(){console.log("Something went wrong renaming this folder!")}})},remove:function(a,b,c){$.ajax({url:bolt.paths.async+"folder/remove",type:"POST",data:{namespace:a,parent:b,foldername:c},success:function(){document.location.reload()},error:function(){console.log("Something went wrong renaming this folder!")}})}});bolt.datetimes=function(){function a(a){var b,c,d,e=moment(a.date.datepicker("getDate")),f=moment([2001,11,24]),g=!1;if(a.time.exists&&(d=a.time.val().match(/^\s*(?:(?:([01]?[0-9]|2[0-3])[:,.]([0-5]?[0-9]))|(1[012]|0?[1-9])[:,.]([0-5]?[0-9])(?:\s*([AP])[. ]?M\.?))\s*$/i),d&&(b=parseInt(d[1]?d[1]:d[3]),c=parseInt(d[2]?d[2]:d[4]),"p"!==d[5]&&"P"!==d[5]||12===b?"a"!==d[5]&&"A"!==d[5]||12!==b||(b-=12):b+=12,f=moment([2001,11,24,b,c]),g=!0)),e.isValid()){var h=a.time.exists?" "+f.format("HH:mm:00"):"";a.data.val(e.format("YYYY-MM-DD")+h)}else a.data.val(g?moment().format("YYYY-MM-DD")+" "+f.format("HH:mm:00"):"")}function b(a){var b,c,d,f,g="",h="";"datedepublish"===a.data.attr("id")&&"1900-01-01 00:00:00"===a.data.val()&&a.data.val(""),c=a.data.val().match(/^(\d{4}-\d{2}-\d{2})(?: (\d{2}:\d{2}:\d{2}))?$/),c&&(g=c[1],h=c[2]||""),d=""===g||"0000-00-00"===g?"":$.datepicker.parseDate("yy-mm-dd",g),a.date.datepicker("setDate",d),a.time.exists&&(""===h?h=""!==g?"00:00":"":e?h=a.data.val().slice(11,16):(b=parseInt(h.slice(0,2)),f=12>b?" AM":" PM",h=(b%12||12)+h.slice(2,5)+f),a.time.val(h)),a.data.trigger("change")}function c(a){var c=a.date.data("field-options"),d={showOn:"none"};for(var e in c)c.hasOwnProperty(e)&&(d[e]=c[e]);a.date.datepicker(d),a.show.click(function(){a.date.datepicker("show")}),a.clear.click(function(){a.data.val(""),b(a)})}function d(a){var b={},c=a.next();return b.data=a,b.date=c.find("input.datepicker"),b.time=c.find("input.timepicker"),b.show=c.find("button.btn-tertiary"),b.clear=c.find("button.btn-default"),b.time.exists=b.time.length>0,b}var e,f=[];return{init:function(){$.datepicker.setDefaults($.datepicker.regional[bolt.locale["long"]]),e=moment.localeData()._longDateFormat.LT.replace(/\[.+?\]/gi,"").match(/A/)?!1:!0,$("input.datetime").each(function(){var e=d($(this));f.push(e),c(e),b(e),e.date.change(function(){a(e),b(e)}),e.time.change(function(){a(e),b(e)})})},update:function(){for(var a in f)b(f[a])}}}(),Object.extend=function(a,b){var c=function(){};b.constructor!==Object&&(c=b.constructor),c.prototype=new a;for(var d in b)"constructor"!==d&&(c.prototype[d]=b[d]);return c};var delay=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),active_console,active_interval,BoltExtender=Object.extend(Object,{selector:".extend-bolt-container",messages:{},paths:{},constructor:function(){jQuery(this.selector).on("change",this,this.events.change),jQuery(this.selector).on("click",this,this.events.click),jQuery(document).ajaxStart(function(){active_interval=setInterval(function(){active_console&&active_console.append(".")},1e3)}).ajaxSuccess(function(){clearInterval(active_interval)}),this.checkInstalled(),this.liveSearch(),this.installReset()},find:function(a){return jQuery(this.selector).find(a)},setMessage:function(a,b){this.messages[a]=b},setPath:function(a,b){this.paths[a]=b},installReset:function(){var a=this;jQuery("#installModal").on("hide.bs.modal",function(){a.find(".stable-version-container .installed-version-item").html('<tr><td colspan="3"><strong>'+a.messages.noStable+"</strong></td></tr>"),a.find(".dev-version-container .installed-version-item").html('<tr><td colspan="3"><strong>'+a.messages.noTest+"</strong></td></tr>"),a.find(".install-response-container .console").html(a.messages.installing),a.find(".theme-postinstall").hide(),a.find(".theme-generate-response").hide(),a.find(".extension-postinstall").hide(),a.find(".install-response-container").hide(),a.find(".install-version-container").hide(),a.find("#installModal .loader").show()})},updateCheck:function(){var a,b=this;b.find(".update-container").show(),a=b.find(".update-list-items"),active_console=b.find(".update-output"),active_console.html(b.messages.updating),jQuery.get(baseurl+"check",function(c){if(c.updates.length>0||c.installs.length>0){var d,e;for(d in c.installs)e=c.installs[d],a.append('<tr data-package="'+e+'"><td class="ext-list"><strong class="title">'+e+'</strong></td><td> <a data-request="update-package" class="btn btn-sm btn-warning" data-package="'+e+'">Install New Package</a></td></tr>');for(d in c.updates)e=c.updates[d],a.append("<tr data-package='"+e+"'><td class='ext-list'><strong class='title'>"+e+"</strong></td><td> <a data-request='update-package' class='btn btn-sm btn-tertiary' data-package='"+e+"'>Install Package Update</a></td></tr>");active_console.hide(),b.find(".update-list").show()}else active_console.html(b.messages.updated);b.updateLog()})},updateRun:function(){var a=this;a.find(".update-container").show();var b=a.find(".update-output");active_console=b,active_console.html("Running update...."),a.updateLog(),jQuery.get(baseurl+"update",function(c){b.html(c),setTimeout(function(){a.find(".update-container").hide()},7e3),a.updateLog()})},updatePackage:function(a){var b=this,c=this.find(".update-output").html(b.messages.updating),d=jQuery(a.target).data("package");c.show(),active_console=c,jQuery.get(baseurl+"update?package="+d).success(function(a){b.find(".update-output").html(a),b.find('.update-list-items tr[data-package="'+d+'"]').remove(),delay(function(){active_console.hide()},4e3),b.find(".update-list-items tbody tr").length<1&&b.find(".update-container").hide(),b.checkInstalled(),b.updateLog()}),a.preventDefault()},installRun:function(a){var b=this;b.find(".update-container").show();var c=b.find(".update-output");active_console=c,active_console.html(b.messages.installAll),jQuery.get(baseurl+"installAll",function(a){c.html(a),delay(function(){b.find(".update-container").hide()},7e3),b.updateLog()}),a.stopPropagation(),a.preventDefault()},checkInstalled:function(){var a=this;a.find(".installed-container").each(function(){active_console=a.find(".installed-container .console");var b=jQuery(this).find(".installed-list");jQuery.get(baseurl+"installed",function(c){if(b.show(),c.length>0){active_console.html(c.length+" installed extension(s)."),a.find(".installed-container .console").hide(),b.find(".installed-list-items").html("");for(var d in c){var e,f=c[d],g='<div class="panel panel-default"><div class="panel-heading">';if(g+=f.title?'<i class="fa fa-cube fa-fw"></i> '+f.title+' <span class="pull-right text-muted">'+f.name+" - "+f.version+"</span> ":'<i class="fa fa-cube fa-fw"></i> '+f.name+" - "+f.version,f.authors){g+='<span class="authors">';var h=f.authors;for(e=0;e<h.length;e++)g+='<span class="author label label-primary">'+h[e].name+"</span> ";g+="</span> "}if(g+="</div> ",g+='<div class="panel-body">',g+="<div class='actions pull-right'><div class='btn-group'> ",f.readmelink&&(g+="<a data-request='package-readme' data-readme='"+f.readmelink+"' class='btn btn-sm btn-tertiary' href=''><i class='fa fa-quote-right fa-fw'></i> Readme</a> "),f.config&&(g+="<a href='"+f.config+"' class='btn btn-sm btn-tertiary' ><i class='fa fa-cog fa-fw'></i> Config</a> "),"bolt-theme"===f.type&&(g+="<a data-request='package-copy' data-theme='"+f.name+"' class='btn btn-sm btn-tertiary' href=''><i class='fa fa-copy fa-fw'></i> Copy to theme folder</a> "),g+="</div> ",g+="<a data-request='uninstall-package' class='btn btn-sm btn-danger' href='"+baseurl+"uninstall?package="+f.name+"'><i class='fa fa-trash-o fa-fw'></i> Uninstall</a>",g+="</div> ",g+='<div class="description text-muted">'+f.descrip+"</div> ",f.keywords){g+="<span class='tags'><i class='fa fa-tag ta-fw'></i> ";var i=f.keywords.split(",");for(e=0;e<i.length;e++)g+="<span class='tag label label-info'>"+i[e]+"</span> ";g+="</span>"}g+="<i class='fa fa-briefcase ta-fw'></i> <span class='type label label-default'>"+f.type+"</span> ",g+="</div></div>",b.find(".installed-list-items").append(g)}}else b.find(".installed-list-items").html('<div class="ext-list"><strong class="no-results">No Bolt Extensions installed.</strong></div>'),active_console.hide();a.updateLog()})})},checkPackage:function(a){var b=this,c=this.find('input[name="check-package"]').val(),d=this.find('input[name="check-package"]').data("packagename");d&&(c=d),active_console=!1,jQuery.get(baseurl+"installInfo?package="+c,function(a){var c=a.dev,d=a.stable;c.length>0&&(b.find(".dev-version-container .installed-version-item").html(""),b.find(".dev-version-container .installed-version-item").append(b.buildVersionTable(c))),d.length>0&&(b.find(".stable-version-container .installed-version-item").html(""),b.find(".stable-version-container .installed-version-item").append(b.buildVersionTable(d))),b.find(".install-version-container").show(),b.find("#installModal .loader").hide(),b.updateLog()}),a.preventDefault()},buildVersionTable:function(a){var b,c,d="";for(var e in a)b=a[e],c="approved"===b.buildStatus?" label-success":"",d+="<tr><td>"+b.name+"</td><td>"+b.version+'</td><td><span class="label label-default'+c+'">'+b.buildStatus+'</span></td><td><div class="btn-group"><a href="#" data-request="install-package" class="btn btn-primary btn-sm" data-package="'+b.name+'" data-version="'+b.version+'"><i class="icon-gears"></i> Install This Version</a></div></td></tr>';return d},install:function(a){var b=this,c=jQuery(a.target).data("package"),d=jQuery(a.target).data("version");b.find(".install-response-container").show(),b.find(".install-version-container").hide(),active_console=b.find(".install-response-container .console"),active_console.html(b.messages.installing),b.find("#installModal .loader .message").html(b.messages.installing),jQuery.get(baseurl+"install",{"package":c,version:d}).done(function(a){active_console.html(a),b.postInstall(c,d),b.find(".check-package").show(),b.find('input[name="check-package"]').val(""),b.checkInstalled(),b.updateLog()}),a.preventDefault()},postInstall:function(a,b){var c=this;jQuery.get(baseurl+"packageInfo",{"package":a,version:b}).done(function(a){"bolt-extension"===a.type&&c.extensionPostInstall(a),"bolt-theme"===a.type&&c.themePostInstall(a),c.updateLog()})},extensionPostInstall:function(a){var b=this;b.find(".extension-postinstall .ext-link").attr("href",a.source),b.find(".extension-postinstall").show()},themePostInstall:function(a){var b=this;b.find(".install-response-container").hide(),b.find(".theme-postinstall").show(),b.find(".theme-generation-container").show();var c=a.name.split(/\/+/).pop();b.find(".theme-postinstall .theme-generator").data("theme",a.name),b.find(".theme-postinstall #theme-name").val(c)},generateTheme:function(a){var b=this,c=jQuery(a.target),d=c.data("theme"),e=b.find("#theme-name").val();jQuery.get(baseurl+"generateTheme",{theme:d,name:e}).done(function(a){b.find(".theme-generate-response").html("<p>"+a+"</p>").show(),b.find(".theme-generation-container").hide(),b.updateLog()}),a.preventDefault()},copyTheme:function(a){var b=this,c=jQuery(a.target),d=c.data("theme"),e=b.find("#theme-name").val();if(confirm(b.messages.overwrite)){var f=b.find(".installed-container .console").html(b.messages.copying);f.show(),active_console=f,jQuery.get(baseurl+"generateTheme",{theme:d,name:e}).done(function(a){active_console.html(a),b.updateLog(),delay(function(){f.hide()},5e3)})}a.preventDefault()},packageReadme:function(a){var b=this;jQuery.get(jQuery(a.target).data("readme")).done(function(a){bootbox.dialog({message:a}),b.updateLog()}),a.preventDefault()},uninstall:function(a){if(confirm("Please confirm that you want to remove this extension?")===!1)return a.stopPropagation(),a.preventDefault(),!1;var b=this,c=this.find(".installed-container .console").html(b.messages.removing);c.show(),active_console=c,jQuery.get(jQuery(a.target).attr("href")).done(function(a){b.find(".installed-container .console").html(a),b.checkInstalled(),delay(function(){active_console.hide()},2e3),b.updateLog()}),a.preventDefault()},liveSearch:function(){var a=this.find('input[name="check-package"]');a.on("keyup",function(){var b=jQuery(this).val();b.length<3||delay(function(){jQuery.ajax({url:site+"list.json",dataType:"jsonp",data:{name:b}}).success(function(b){if(!(b.packages.length<1)){var c=a.parent().find(".auto-search");c.html("").show();for(var d in b.packages){var e=b.packages[d],f='data-request="prefill-package" data-packagename="'+e.name+'"';c.append('<a class="btn btn-block btn-default prefill-package" '+f+'style="text-align: left;">'+e.title+" <small "+f+">("+e.authors+" - "+e.name+")</small></a>")}a.on("blur",function(){c.fadeOut()})}})},500)})},prefill:function(a){var b=jQuery(a.target);this.find('input[name="check-package"]').val(b.closest("a").text()),this.find('input[name="check-package"]').data("packagename",b.data("packagename")),this.find(".auto-search").hide()},updateLog:function(){jQuery.get(baseurl+"getLog",function(a){$("#extension-log").html(a),$("#extension-log").animate({scrollTop:$("#extension-log")[0].scrollHeight},"fast")})},clearLog:function(){$("#extension-log").html(""),jQuery.get(baseurl+"clearLog",function(){})},events:{change:function(a){a.data},click:function(a){var b=a.data,c=jQuery(a.target).data("request");switch(c){case"update-check":b.updateCheck();break;case"update-run":b.updateRun();break;case"update-package":b.updatePackage(a.originalEvent);break;case"check-package":b.checkPackage(a.originalEvent);break;case"uninstall-package":b.uninstall(a.originalEvent);break;case"install-package":b.install(a.originalEvent);break;case"prefill-package":b.prefill(a.originalEvent);break;case"install-run":b.installRun(a.originalEvent);break;case"generate-theme":b.generateTheme(a.originalEvent);break;case"package-copy":b.copyTheme(a.originalEvent);break;case"package-readme":b.packageReadme(a.originalEvent);break;case"package-config":b.packageConfig(a.originalEvent);break;case"clear-log":b.clearLog(a.originalEvent)}}}}),init={activityWidget:function(){$("#latestactivity").is("*")&&setTimeout(function(){updateLatestActivity()},2e4)},depublishTracking:function(){var a="dateDepublishNotice",b=$("#datedepublish").data("notice");$("#datedepublish, #statusselect").on("change",function(){var c=$("#statusselect").val(),d=$("#datedepublish").val();$("."+a).remove(),""!==d&&"published"===c&&moment(d+bolt.timezone.offset)<moment()&&$('<div class="'+a+' alert alert-warning"><button class="close" data-dismiss="alert">×</button>'+b+"</div>").hide().insertAfter(".depublish-group").slideDown("fast")}),$("#datedepublish").trigger("change")},bindEditContent:function(a){$("#editcontent").attr("novalidate","novalidate").on("submit",function(a){var b=validateContent(this);return $(this).data("valid",b),b?void(window.onbeforeunload=null):(a.preventDefault(),!1)}),$("#editcontent").on("boltvalidate",function(){var a=validateContent(this);return $(this).data("valid",a),a}),$("#sidebarsavebutton").bind("click",function(){$("#savebutton").trigger("click")}),$("#savebutton").bind("click",function(){$("form").watchChanges()}),$("#sidebarsavenewbutton, #savenewbutton").bind("click",function(){$("form").watchChanges();var a="?returnto=saveandnew";$("#editcontent").attr("action",a).submit()
}),$("#sidebarsavecontinuebutton, #savecontinuebutton").bind("click",function(b){if(b.preventDefault(),$("#editcontent").trigger("boltvalidate"),!$("#editcontent").data("valid"))return!1;var c=a.newRecord,d=a.savedon,e=a.msgNotSaved;if($("#sidebarsavecontinuebutton, #savecontinuebutton").addClass("disabled"),$("p.lastsaved").text(a.msgSaving),c){$("form").watchChanges();var f="?returnto=new";$("#editcontent").attr("action",f).submit()}else{$("form").watchChanges();var g="?returnto=ajax";$.post(g,$("#editcontent").serialize()).done(function(a){$("p.lastsaved").html(d),$("p.lastsaved").find("strong").text(moment(a.datechanged).format("MMM D, HH:mm")),$("p.lastsaved").find("time").attr("datetime",moment(a.datechanged).format()),$("p.lastsaved").find("time").attr("title",moment(a.datechanged).format()),bolt.moments.update(),$("a#lastsavedstatus strong").html('<i class="fa fa-circle status-'+$("#statusselect option:selected").val()+'"></i> '+$("#statusselect option:selected").text()),"object"===$.type(a)&&$.each(a,function(a,b){"object"===$.type(b)?$.each(b,function(b,c){$(":input[name='"+a+"["+b+"]']").val(c)}):$(":input[name='"+a+"']").val(b)}),bolt.datetimes.update(),$("form").watchChanges()}).fail(function(){$("p.lastsaved").text(e)}).always(function(){$("#sidebarsavecontinuebutton, #savecontinuebutton").removeClass("disabled")})}}),$("#previewbutton, #sidebarpreviewbutton").bind("click",function(b){b.preventDefault();var c=a.pathsRoot+"preview/"+a.singularSlug;$("#editcontent").attr("action",c).attr("target","_blank").submit(),$("#editcontent").attr("action","").attr("target","_self")}),a.hasGroups&&window.setTimeout(function(){var a=$(".tabgrouping");a.hide(),$(".filter").click(function(){var b=$(this).data("filter");a.hide().filter(function(){return $(this).data("tab")===b}).show(),$("#filtertabs li").removeClass("active"),$(this).parent().attr("class","active")}),$(document).ready(function(){$("#filtertabs li a:first").trigger("click")})},200)},bindEditFile:function(a){$("#saveeditfile").bind("click",function(){window.onbeforeunload=null});var b=CodeMirror.fromTextArea(document.getElementById("form_contents"),{lineNumbers:!0,autofocus:!0,tabSize:4,indentUnit:4,indentWithTabs:!1,readOnly:a.readonly}),c=$(window).height()-312;200>c&&(c=200),b.setSize(null,c)},bindEditLocale:function(a){var b=CodeMirror.fromTextArea(document.getElementById("form_contents"),{lineNumbers:!0,autofocus:!0,tabSize:4,indentUnit:4,indentWithTabs:!1,readOnly:a.readonly});b.setSize(null,$(window).height()-276)},bindFileBrowser:function(){$("#myTab a").click(function(a){a.preventDefault(),$(this).tab("show")});var a=function(a){var b=new RegExp("(?:[?&]|&)"+a+"=([^&]+)","i"),c=window.location.search.match(b);return c&&c.length>1?c[1]:null},b=a("CKEditorFuncNum");$("a.filebrowserCallbackLink").bind("click",function(a){a.preventDefault();var c=$(this).attr("href");window.opener.CKEDITOR.tools.callFunction(b,c),window.close()}),$("a.filebrowserCloseLink").bind("click",function(){window.close()})},bindCkFileSelect:function(){var a=function(a){var b=new RegExp("(?:[?&]|&)"+a+"=([^&]+)","i"),c=window.location.search.match(b);return c&&c.length>1?c[1]:null},b=a("CKEditorFuncNum");$("a.filebrowserCallbackLink").bind("click",function(a){a.preventDefault();var c=$(this).attr("href");window.opener.CKEDITOR.tools.callFunction(b,c),window.close()})},bindPrefill:function(){$("#check-all").on("click",function(){$("#form_contenttypes :checkbox").removeAttr("checked").trigger("click")}),$("#uncheck-all").on("click",function(){$("#form_contenttypes :checkbox").removeAttr("checked")})},bindSlug:function(a){$(".sluglocker").bind("click",function(){$(".sluglocker i").hasClass("fa-lock")?(a.isEmpty||confirm(a.messageUnlock))&&($(".sluglocker i").removeClass("fa-lock").addClass("fa-unlock"),makeUri(a.slug,a.contentId,a.uses,a.key,!1)):($(".sluglocker i").addClass("fa-lock").removeClass("fa-unlock"),stopMakeUri(a.uses))}),$(".slugedit").bind("click",function(){var b=prompt(a.messageSet,$("#show-"+a.key).text());b&&($(".sluglocker i").addClass("fa-lock").removeClass("fa-unlock"),stopMakeUri(a.uses),makeUriAjax(b,a.slug,a.contentId,a.key,!1))}),a.isEmpty&&$(".sluglocker").trigger("click")},bindUserAgents:function(){$(".useragent").each(function(){var a=new UAParser($(this).data("ua")),b=a.getResult();$(this).html(b.browser.name+" "+b.browser.major+" / "+b.os.name+" "+b.os.version)})},bindVideo:function(a){bindVideoEmbed(a.key)},ckeditor:function(){CKEDITOR.editorConfig=function(a){var b,c,d=bolt.ckeditor,e=["Bold","Italic"],f=["Link","Unlink"],g=["RemoveFormat","Maximize","-","Source"],h=["NumberedList","BulletedList","Indent","Outdent"];d.underline&&(e=e.concat("Underline")),d.strike&&(e=e.concat("Strike")),d.anchor&&(f=f.concat("-","Anchor")),d.specialchar&&(g=["SpecialChar","-"].concat(g)),d.blockquote&&(h=h.concat("-","Blockquote")),a.language=bolt.locale["short"],a.uiColor="#DDDDDD",a.resize_enabled=!0,a.entities=!1,a.extraPlugins="codemirror",a.toolbar=[{name:"styles",items:["Format"]},{name:"basicstyles",items:e},{name:"paragraph",items:h},{name:"links",items:f}],d.subsuper&&(a.toolbar=a.toolbar.concat({name:"subsuper",items:["Subscript","Superscript"]})),d.images&&(a.toolbar=a.toolbar.concat({name:"image",items:["Image"]})),d.embed&&(a.extraPlugins+=",oembed,widget",a.oembed_maxWidth="853",a.oembed_maxHeight="480",a.toolbar=a.toolbar.concat({name:"embed",items:["oembed"]})),d.tables&&(a.toolbar=a.toolbar.concat({name:"table",items:["Table"]})),d.align&&(a.toolbar=a.toolbar.concat({name:"align",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]})),d.fontcolor&&(a.toolbar=a.toolbar.concat({name:"colors",items:["TextColor","BGColor"]})),d.codesnippet&&(a.toolbar=a.toolbar.concat({name:"code",items:["-","CodeSnippet"]})),a.toolbar=a.toolbar.concat({name:"tools",items:g}),a.height=250,a.autoGrow_onStartup=!0,a.autoGrow_minHeight=150,a.autoGrow_maxHeight=400,a.autoGrow_bottomSpace=24,a.removePlugins="elementspath",a.resize_dir="vertical",d.filebrowser?(d.filebrowser.browseUrl&&(a.filebrowserBrowseUrl=d.filebrowser.browseUrl),d.filebrowser.imageBrowseUrl&&(a.filebrowserImageBrowseUrl=d.filebrowser.imageBrowseUrl),d.filebrowser.uploadUrl&&(a.filebrowserUploadUrl=d.filebrowser.uploadUrl),d.filebrowser.imageUploadUrl&&(a.filebrowserImageUploadUrl=d.filebrowser.imageUploadUrl)):(a.filebrowserBrowseUrl="",a.filebrowserImageBrowseUrl="",a.filebrowserUploadUrl="",a.filebrowserImageUploadUrl=""),a.codemirror={theme:"default",lineNumbers:!0,lineWrapping:!0,matchBrackets:!0,autoCloseTags:!0,autoCloseBrackets:!0,enableSearchTools:!0,enableCodeFolding:!0,enableCodeFormatting:!1,autoFormatOnStart:!1,autoFormatOnUncomment:!1,autoFormatOnModeChange:!1,highlightActiveLine:!0,highlightMatches:!0,showFormatButton:!1,showCommentButton:!1,showUncommentButton:!1};for(b in d.ck)d.ck.hasOwnProperty(b)&&(a[b]=d.ck[b]);c=$("textarea[name="+this.name+"]").data("field-options");for(b in c)c.hasOwnProperty(b)&&(a[b]=c[b])}},confirmationDialogs:function(){$(".confirm").on("click",function(){return confirm($(this).data("confirm"))})},dashboardCheckboxes:function(){$(".dashboardlisting tr th:first-child input:checkbox").click(function(){var a=this.checked;$(".dashboardlisting tr td:first-child input:checkbox").each(function(){this.checked=a,a===this.checked&&$(this).closest("table tbody tr").removeClass("row-checked"),this.checked&&$(this).closest("table tbody tr").addClass("row-checked")})}),$(".dashboardlisting input:checkbox").click(function(){var a=getSelectedItems();a.length>=1?($("a.checkchosen").removeClass("disabled"),$("a.showifchosen").show()):($("a.checkchosen").addClass("disabled"),$("a.showifchosen").hide())}),$("a.deletechosen").click(function(a){a.preventDefault();var b,c,d=getSelectedItems();d.length<1?bootbox.alert("Nothing chosen to delete"):(c=1===d.length?"this record":"these records",b="Are you sure you wish to <strong>delete "+c+"</strong>? There is no undo.",bootbox.confirm(b,function(a){$(".alert").alert(),a===!0&&$.each(d,function(a,b){$.ajax({url:$("#baseurl").attr("value")+"content/deletecontent/"+$("#item_"+b).closest("table").data("contenttype")+"/"+b+"?token="+$("#item_"+b).closest("table").data("token"),type:"get",success:function(){$("#item_"+b).hide(),$("a.deletechosen").hide()}})})}))})},dataActions:function(){$("button, input[type=button], a").off("click.action"),$("[data-action]").on("click.action",function(e){var action=$(this).attr("data-action");"undefined"!=typeof action&&""!==action&&(e.preventDefault(),eval(action),e.stopPropagation())}).on("click.popover",".popover",function(a){a.stopPropagation()})},deferredWidgets:function(){$("div.widget").each(function(){if("undefined"!=typeof $(this).data("defer")){var a=$(this).data("key");$.ajax({url:bolt.paths.async+"widget/"+a,type:"GET",success:function(b){$("#widget-"+a).html(b)},error:function(){console.log("failed to get widget")}})}})},dropDowns:function(){$('[data-toggle="dropdown"]').each(function(a,b){var c;"undefined"==typeof event?$(b).parent().click(function(a){c=a}):c=event,$(b).parent().on("show.bs.dropdown",function(){if("undefined"!=typeof c&&null!==c){var a=$(this).find('[data-toggle="dropdown"]'),b=a.next(".dropdown-menu"),d=c.pageY+20,e=b.height(),f=$(window).height()-d+e,g=37;d-e>20&&g>f&&b.css({top:"auto",bottom:"100%"})}})})},geolocation:function(){$("input[data-geolocation]").each(function(){var a=$(this).data("geolocation");bindGeolocation(a.key,a.lat,a.lon)})},dropZone:function(){$(document).bind("dragover",function(a){var b=$(".dropzone"),c=window.dropZoneTimeout;c?clearTimeout(c):b.addClass("in"),a.target===b[0]?b.addClass("hover"):b.removeClass("hover"),window.dropZoneTimeout=setTimeout(function(){window.dropZoneTimeout=null,b.removeClass("in hover")},100)})},keyboardShortcuts:function(){function a(){return $("form").hasChanged()?"You have unfinished changes on this page. If you continue without saving, you will lose these changes.":void 0}($("#sidebarsavecontinuebutton").is("*")||$("#saveeditfile").is("*"))&&($("body, input").bind("keydown.ctrl_s keydown.meta_s",function(a){a.preventDefault(),$("form").watchChanges(),$("#sidebarsavecontinuebutton, #saveeditfile").trigger("click")}),window.setTimeout(function(){$("form").watchChanges()},1e3),window.onbeforeunload=a)},magnificPopup:function(){$(".magnific, .fancybox").magnificPopup({type:"image",gallery:{enabled:!0},disableOn:400,closeBtnInside:!0,enableEscapeKey:!0,mainClass:"mfp-with-zoom",zoom:{enabled:!0,duration:300,easing:"ease-in-out",opener:function(a){return a.parent().parent().find("img")}}})},focusStatusSelect:function(){$("#lastsavedstatus").click(function(a){a.preventDefault(),$('a[data-filter="meta"]').click(),$("#statusselect").focus()})},omnisearch:function(){$(".omnisearch").select2({placeholder:"",minimumInputLength:3,multiple:!0,ajax:{url:bolt.paths.async+"omnisearch",dataType:"json",data:function(a){return{q:a}},results:function(a){var b=[];return $.each(a,function(a,c){b.push({id:c.path,path:c.path,label:c.label,priority:c.priority})}),{results:b}}},formatResult:function(a){var b='<table class="omnisearch-result"><tr><td class="omnisearch-result-info"><div class="omnisearch-result-label">'+a.label+'</div><div class="omnisearch-result-description">'+a.path+"</div></td></tr></table>";return b},formatSelection:function(a){return window.location.href=a.path,a.label},dropdownCssClass:"bigdrop",escapeMarkup:function(a){return a}})},passwordInput:function(){$(".togglepass").on("click",function(){$(this).hasClass("show-password")?($('input[name="password"]').attr("type","text"),$(".togglepass.show-password").hide(),$(".togglepass.hide-password").show()):($('input[name="password"]').attr("type","password"),$(".togglepass.show-password").show(),$(".togglepass.hide-password").hide())}),$(".login-forgot").bind("click",function(){$(".login-group, .password-group").hide(),$(".reset-group").show()}),$(".login-remembered").bind("click",function(){$(".login-group, .password-group").show(),$(".reset-group").hide()})},popOvers:function(){$(".info-pop").popover({trigger:"hover",delay:{show:500,hide:200}})},uploads:function(){$("input[data-upload]").each(function(){var a,b=$(this).data("upload"),c=$(this).attr("accept").replace(/\./g,"");switch(b.type){case"Image":case"File":bindFileUpload(b.key),a={source:bolt.paths.async+"filesautocomplete?ext="+encodeURIComponent(c),minLength:2},"Image"===b.type&&(a.close=function(){var a,c=$("#field-"+b.key).val();a=c?bolt.paths.root+"thumbs/"+b.width+"x"+b.height+"c/"+encodeURI(c):bolt.paths.app+"view/img/default_empty_4x3.png",$("#thumbnail-"+b.key).html('<img src="'+a+'" width="'+b.width+'" height="'+b.height+'">')}),$("#field-"+b.key).autocomplete(a);break;case"ImageList":bolt.imagelist[b.key]=new FilelistHolder({id:b.key,type:b.type});break;case"FileList":bolt.filelist[b.key]=new FilelistHolder({id:b.key,type:b.type})}})},sortables:function(){$("tbody.sortable").sortable({items:"tr",opacity:"0.5",axis:"y",handle:".sorthandle",update:function(){var a=$(this).sortable("serialize");$.ajax({url:$("#baseurl").attr("value")+"content/sortcontent/"+$(this).parent("table").data("contenttype"),type:"POST",data:a,success:function(){}})}})}};String.prototype.subst=function(a){return this.replace(/%[A-Z][A-Z0-9_]+%/g,function(b){return a[b]||b})},jQuery(function(a){var b=a("script[data-config]").first().data("config");for(var c in b)bolt[c]=b[c];bolt.data=a("script[data-jsdata]").first().data("jsdata"),bolt.files=new Files,bolt.folders=new Folders,bolt.stack=new Stack,bolt.sidebar=new Sidebar,bolt.navpopups=new Navpopups,bolt.moments=new Moments,bolt.imagelist=[],bolt.filelist=[],bolt.datetimes.init(),init.ckeditor(),init.confirmationDialogs(),init.magnificPopup(),init.dataActions(),window.setTimeout(function(){init.keyboardShortcuts()},1e3),init.dropZone(),init.popOvers(),init.activityWidget(),init.dropDowns(),init.deferredWidgets(),init.passwordInput(),init.dashboardCheckboxes(),init.sortables(),init.omnisearch(),init.uploads(),init.geolocation(),init.focusStatusSelect(),init.depublishTracking(),a("[data-bind]").each(function(){var b=a(this).data("bind");switch(b.bind){case"editcontent":init.bindEditContent(b);break;case"editfile":init.bindEditFile(b);break;case"editlocale":init.bindEditLocale(b);break;case"filebrowser":init.bindFileBrowser();break;case"ckfileselect":init.bindCkFileSelect();break;case"prefill":init.bindPrefill();break;case"slug":init.bindSlug(b);break;case"useragents":init.bindUserAgents();break;case"video":init.bindVideo(b);break;default:console.log("Binding "+b.bind+" failed!")}})});
//# sourceMappingURL=bolt.min.js.map
