!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/comment/continuecomment.js",["../../lib/codemirror"],a):a(CodeMirror)}(function(a){function m(f){if(f.getOption("disableInput"))return a.Pass;for(var c,b=f.listSelections(),g=[],h=0;h<b.length;h++){var r=b[h].head;if(!/\bcomment\b/.test(f.getTokenTypeAt(r)))return a.Pass;var p=f.getModeAt(r);if(c){if(c!=p)return a.Pass}else c=p;p=null;if(c.blockCommentStart&&
c.blockCommentContinue){var n,l=f.getLine(r.line).slice(0,r.ch),e=l.lastIndexOf(c.blockCommentEnd);if(-1==e||e!=r.ch-c.blockCommentEnd.length)if(-1<(n=l.lastIndexOf(c.blockCommentStart))&&n>e){if(p=l.slice(0,n),/\S/.test(p))for(p="",l=0;l<n;++l)p+=" "}else-1<(n=l.indexOf(c.blockCommentContinue))&&!/\S/.test(l.slice(0,n))&&(p=l.slice(0,n));null!=p&&(p+=c.blockCommentContinue)}null==p&&c.lineComment&&q(f)&&(l=f.getLine(r.line),n=l.indexOf(c.lineComment),-1<n&&(p=l.slice(0,n),/\S/.test(p)?p=null:p+=
c.lineComment+l.slice(n+c.lineComment.length).match(/^\s*/)[0]));if(null==p)return a.Pass;g[h]="\n"+p}f.operation(function(){for(var e=b.length-1;0<=e;e--)f.replaceRange(g[e],b[e].from(),b[e].to(),"+insert")})}function q(a){a=a.getOption("continueComments");return!a||"object"!=typeof a||!1!==a.continueLineComment}a.defineOption("continueComments",null,function(f,c,b){if(b&&b!=a.Init&&f.removeKeyMap("continueComment"),c)b="Enter","string"==typeof c?b=c:"object"==typeof c&&c.key&&(b=c.key),c={name:"continueComment"},
c[b]=m,f.addKeyMap(c)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/closebrackets.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(e,d){return"pairs"==d&&"string"==typeof e?e:"object"==typeof e&&null!=e[d]?e[d]:p[d]}function q(e){for(var d=0;d<e.length;d++){var k=e.charAt(d),b="'"+k+"'";l[b]||(l[b]=f(k))}}function f(e){return function(d){return b(d,e)}}function c(e){var d=e.state.closeBrackets;
return!d||d.override?d:e.getModeAt(e.getCursor()).closeBrackets||d}function b(e,d){var k=c(e);if(!k||e.getOption("disableInput"))return a.Pass;var b=m(k,"pairs"),l=b.indexOf(d);if(-1==l)return a.Pass;for(var h,k=m(k,"triples"),p=b.charAt(l+1)==d,f=e.listSelections(),q=0==l%2,z=0;z<f.length;z++){var w,B=f[z],v=B.head;w=e.getRange(v,n(v.line,v.ch+1));if(q&&!B.empty())w="surround";else if(!p&&q||w!=d)if(p&&1<v.ch&&0<=k.indexOf(d)&&e.getRange(n(v.line,v.ch-2),v)==d+d&&(2>=v.ch||e.getRange(n(v.line,v.ch-
3),n(v.line,v.ch-2))!=d))w="addFour";else{if(p){if(B=0==v.ch?" ":e.getRange(n(v.line,v.ch-1),v),a.isWordChar(w)||B==d||a.isWordChar(B))return a.Pass}else if(!q||e.getLine(v.line).length!=v.ch&&!g(w,b)&&!/\s/.test(w))return a.Pass;w="both"}else w=p&&r(e,v)?"both":0<=k.indexOf(d)&&e.getRange(v,n(v.line,v.ch+3))==d+d+d?"skipThree":"skip";if(h){if(h!=w)return a.Pass}else h=w}var x=l%2?b.charAt(l-1):d,D=l%2?d:b.charAt(l+1);e.operation(function(){if("skip"==h)e.execCommand("goCharRight");else if("skipThree"==
h)for(var d=0;3>d;d++)e.execCommand("goCharRight");else if("surround"==h){for(var k=e.getSelections(),d=0;d<k.length;d++)k[d]=x+k[d]+D;e.replaceSelections(k,"around");k=e.listSelections().slice();for(d=0;d<k.length;d++){var b=k,c=d,t;t=k[d];var l=0<a.cmpPos(t.anchor,t.head);t={anchor:new n(t.anchor.line,t.anchor.ch+(l?-1:1)),head:new n(t.head.line,t.head.ch+(l?1:-1))};b[c]=t}e.setSelections(k)}else"both"==h?(e.replaceSelection(x+D,null),e.triggerElectric(x+D),e.execCommand("goCharLeft")):"addFour"==
h&&(e.replaceSelection(x+x+x+x,"before"),e.execCommand("goCharRight"))})}function g(e,d){var k=d.lastIndexOf(e);return-1<k&&1==k%2}function h(e,d){var k=e.getRange(n(d.line,d.ch-1),n(d.line,d.ch+1));return 2==k.length?k:null}function r(e,d){var k=e.getTokenAt(n(d.line,d.ch+1));return/\bstring/.test(k.type)&&k.start==d.ch&&(0==d.ch||!/\bstring/.test(e.getTokenTypeAt(d)))}var p={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},n=a.Pos;a.defineOption("autoCloseBrackets",!1,function(e,d,k){k&&k!=a.Init&&
(e.removeKeyMap(l),e.state.closeBrackets=null);d&&(q(m(d,"pairs")),e.state.closeBrackets=d,e.addKeyMap(l))});var l={Backspace:function(e){var d=c(e);if(!d||e.getOption("disableInput"))return a.Pass;for(var k=m(d,"pairs"),d=e.listSelections(),b=0;b<d.length;b++){if(!d[b].empty())return a.Pass;var l=h(e,d[b].head);if(!l||0!=k.indexOf(l)%2)return a.Pass}for(b=d.length-1;0<=b;b--)k=d[b].head,e.replaceRange("",n(k.line,k.ch-1),n(k.line,k.ch+1),"+delete")},Enter:function(e){var d=c(e),d=d&&m(d,"explode");
if(!d||e.getOption("disableInput"))return a.Pass;for(var k=e.listSelections(),b=0;b<k.length;b++){if(!k[b].empty())return a.Pass;var l=h(e,k[b].head);if(!l||0!=d.indexOf(l)%2)return a.Pass}e.operation(function(){var d=e.lineSeparator()||"\n";e.replaceSelection(d+d,null);e.execCommand("goCharLeft");k=e.listSelections();for(d=0;d<k.length;d++){var b=k[d].head.line;e.indentLine(b,null,!0);e.indentLine(b+1,null,!0)}})}};q(p.pairs+"`")});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/xml-fold",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(e,d,k,b){this.line=d;this.ch=k;this.cm=e;this.text=e.getLine(d);this.min=b?Math.max(b.from,e.firstLine()):e.firstLine();this.max=b?Math.min(b.to-1,e.lastLine()):e.lastLine()}function q(e,d){var b=e.cm.getTokenTypeAt(n(e.line,d));return b&&/\btag\b/.test(b)}function f(e){if(!(e.line>=
e.max))return e.ch=0,e.text=e.cm.getLine(++e.line),!0}function c(e){if(!(e.line<=e.min))return e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0}function b(e){for(;;){var d=e.text.indexOf("\x3e",e.ch);if(-1==d){if(f(e))continue;break}if(q(e,d+1)){var b=e.text.lastIndexOf("/",d),b=-1<b&&!/\S/.test(e.text.slice(b+1,d));return e.ch=d+1,b?"selfClose":"regular"}e.ch=d+1}}function g(e){for(;;){var d=e.ch?e.text.lastIndexOf("\x3c",e.ch-1):-1;if(-1==d){if(c(e))continue;break}if(q(e,d+1)){l.lastIndex=d;
e.ch=d;var b=l.exec(e.text);if(b&&b.index==d)return b}else e.ch=d}}function h(e){for(;;){l.lastIndex=e.ch;var d=l.exec(e.text);if(!d){if(f(e))continue;break}if(q(e,d.index+1))return e.ch=d.index+d[0].length,d;e.ch=d.index+1}}function r(e,d){for(var k=[];;){var a,c=h(e),l=e.line,g=e.ch-(c?c[0].length:0);if(!c||!(a=b(e)))break;if("selfClose"!=a)if(c[1]){for(var p=k.length-1;0<=p;--p)if(k[p]==c[2]){k.length=p;break}if(0>p&&(!d||d==c[2]))return{tag:c[2],from:n(l,g),to:n(e.line,e.ch)}}else k.push(c[2])}}
function p(e,d){for(var b=[];;){var a;a:for(a=e;;){var l=a.ch?a.text.lastIndexOf("\x3e",a.ch-1):-1;if(-1==l){if(c(a))continue;a=void 0;break a}if(q(a,l+1)){var h=a.text.lastIndexOf("/",l),h=-1<h&&!/\S/.test(a.text.slice(h+1,l));a=(a.ch=l+1,h?"selfClose":"regular");break a}a.ch=l}if(!a)break;if("selfClose"!=a){a=e.line;l=e.ch;h=g(e);if(!h)break;if(h[1])b.push(h[2]);else{for(var p=b.length-1;0<=p;--p)if(b[p]==h[2]){b.length=p;break}if(0>p&&(!d||d==h[2]))return{tag:h[2],from:n(e.line,e.ch),to:n(a,l)}}}else g(e)}}
var n=a.Pos,l=RegExp("\x3c(/?)([A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");a.registerHelper("fold","xml",function(e,d){for(var k=new m(e,d.line,0);;){var a,
c=h(k);if(!c||k.line!=d.line||!(a=b(k)))break;if(!c[1]&&"selfClose"!=a)return a=n(k.line,k.ch),(k=r(k,c[2]))&&{from:a,to:k.from}}});a.findMatchingTag=function(e,d,a){var c=new m(e,d.line,d.ch,a);if(-1!=c.text.indexOf("\x3e")||-1!=c.text.indexOf("\x3c")){var l=b(c),h=l&&n(c.line,c.ch),f=l&&g(c);if(l&&f&&!(0<(c.line-d.line||c.ch-d.ch)))return d={from:n(c.line,c.ch),to:h,tag:f[2]},"selfClose"==l?{open:d,close:null,at:"open"}:f[1]?{open:p(c,f[2]),close:d,at:"close"}:(c=new m(e,h.line,h.ch,a),{open:d,
close:r(c,f[2]),at:"open"})}};a.findEnclosingTag=function(b,d,a,c){for(var l=new m(b,d.line,d.ch,a);;){var h=p(l,c);if(!h)break;var g=new m(b,d.line,d.ch,a);if(g=r(g,h.tag))return{open:h,close:g}}};a.scanForClosingTag=function(b,d,a,c){return r(new m(b,d.line,d.ch,c?{from:0,to:c}:null),a)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("addon/edit/closetag.js",["../../lib/codemirror","../fold/xml-fold"],a):a(CodeMirror)})(function(a){function m(h){if(h.getOption("disableInput"))return a.Pass;for(var r=h.listSelections(),p=[],n=h.getOption("autoCloseTags"),l=0;l<r.length;l++){if(!r[l].empty())return a.Pass;var e=r[l].head,d=h.getTokenAt(e),k=a.innerMode(h.getMode(),
d.state),t=k.state;if("xml"!=k.mode.name||!t.tagName)return a.Pass;var u="html"==k.mode.configuration,k="object"==typeof n&&n.dontCloseTags||u&&b,q="object"==typeof n&&n.indentTags||u&&g,u=t.tagName;d.end>e.ch&&(u=u.slice(0,u.length-d.end+e.ch));var m=u.toLowerCase();if(!u||"string"==d.type&&(d.end!=e.ch||!/[\"\']/.test(d.string.charAt(d.string.length-1))||1==d.string.length)||"tag"==d.type&&"closeTag"==t.type||d.string.indexOf("/")==d.string.length-1||k&&-1<f(k,m)||c(h,u,e,t,!0))return a.Pass;d=
q&&-1<f(q,m);p[l]={indent:d,text:"\x3e"+(d?"\n\n":"")+"\x3c/"+u+"\x3e",newPos:d?a.Pos(e.line+1,0):a.Pos(e.line,e.ch+1)}}n="object"==typeof n&&n.dontIndentOnAutoClose;for(l=r.length-1;0<=l;l--)e=p[l],h.replaceRange(e.text,r[l].head,r[l].anchor,"+insert"),d=h.listSelections().slice(0),d[l]={head:e.newPos,anchor:e.newPos},h.setSelections(d),!n&&e.indent&&(h.indentLine(e.newPos.line,null,!0),h.indentLine(e.newPos.line+1,null,!0))}function q(b,g){for(var p=b.listSelections(),n=[],l=g?"/":"\x3c/",e=b.getOption("autoCloseTags"),
e="object"==typeof e&&e.dontIndentOnSlash,d=0;d<p.length;d++){if(!p[d].empty())return a.Pass;var k=p[d].head,t=b.getTokenAt(k),f=a.innerMode(b.getMode(),t.state),q=f.state;if(g&&("string"==t.type||"\x3c"!=t.string.charAt(0)||t.start!=k.ch-1))return a.Pass;if("xml"!=f.mode.name)if("htmlmixed"==b.getMode().name&&"javascript"==f.mode.name)f=l+"script";else{if("htmlmixed"!=b.getMode().name||"css"!=f.mode.name)return a.Pass;f=l+"style"}else{if(!q.context||!q.context.tagName||c(b,q.context.tagName,k,q))return a.Pass;
f=l+q.context.tagName}"\x3e"!=b.getLine(k.line).charAt(t.end)&&(f+="\x3e");n[d]=f}if(b.replaceSelections(n),p=b.listSelections(),!e)for(d=0;d<p.length;d++)(d==p.length-1||p[d].head.line<p[d+1].head.line)&&b.indentLine(p[d].head.line)}function f(b,a){if(b.indexOf)return b.indexOf(a);for(var c=0,g=b.length;c<g;++c)if(b[c]==a)return c;return-1}function c(b,c,g,n,l){if(!a.scanForClosingTag)return!1;var e=Math.min(b.lastLine()+1,g.line+500);g=a.scanForClosingTag(b,g,null,e);if(!g||g.tag!=c)return!1;n=
n.context;for(l=l?1:0;n&&n.tagName==c;n=n.prev)++l;g=g.to;for(n=1;n<l;n++){g=a.scanForClosingTag(b,g,null,e);if(!g||g.tag!=c)return!1;g=g.to}return!0}a.defineOption("autoCloseTags",!1,function(b,c,g){if(g!=a.Init&&g&&b.removeKeyMap("autoCloseTags"),c)g={name:"autoCloseTags"},("object"!=typeof c||c.whenClosing)&&(g["'/'"]=function(b){return b.getOption("disableInput")?a.Pass:q(b,!0)}),("object"!=typeof c||c.whenOpening)&&(g["'\x3e'"]=function(b){return m(b)}),b.addKeyMap(g)});var b="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),
g="applet blockquote body button div dl fieldset form frameset h1 h2 h3 h4 h5 h6 head html iframe layer legend object ol p select table ul".split(" ");a.commands.closeTag=function(b){return q(b)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/matchbrackets.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(b,c,a){var e=b.getLineHandle(c.line),d=c.ch-1,k=a&&a.afterCursor;null==k&&(k=/(^| )cm-fat-cursor($| )/.test(b.getWrapperElement().className));e=!k&&0<=d&&h[e.text.charAt(d)]||h[e.text.charAt(++d)];if(!e)return null;k="\x3e"==e.charAt(1)?1:-1;if(a&&a.strict&&0<k!=
(d==c.ch))return null;var f=b.getTokenTypeAt(g(c.line,d+1));b=q(b,g(c.line,d+(0<k?1:0)),k,f||null,a);return null==b?null:{from:g(c.line,d),to:b&&b.pos,match:b&&b.ch==e.charAt(0),forward:0<k}}function q(b,c,a,e,d){var k=d&&d.maxScanLineLength||1E4,f=d&&d.maxScanLines||1E3,r=[];d=d&&d.bracketRegex?d.bracketRegex:/[(){}[\]]/;for(var f=0<a?Math.min(c.line+f,b.lastLine()+1):Math.max(b.firstLine()-1,c.line-f),q=c.line;q!=f;q+=a){var m=b.getLine(q);if(m){var A=0<a?0:m.length-1,E=0<a?m.length:-1;if(!(m.length>
k))for(q==c.line&&(A=c.ch-(0>a?1:0));A!=E;A+=a){var z=m.charAt(A);if(d.test(z)&&(void 0===e||b.getTokenTypeAt(g(q,A+1))==e))if("\x3e"==h[z].charAt(1)==0<a)r.push(z);else{if(!r.length)return{pos:g(q,A),ch:z};r.pop()}}}}return q-a!=(0<a?b.lastLine():b.firstLine())&&null}function f(c,a,l){for(var e=c.state.matchBrackets.maxHighlightLineLength||1E3,d=[],k=c.listSelections(),h=0;h<k.length;h++){var f=k[h].empty()&&m(c,k[h].head,l);if(f&&c.getLine(f.from.line).length<=e){var r=f.match?"CodeMirror-matchingbracket":
"CodeMirror-nonmatchingbracket";d.push(c.markText(f.from,g(f.from.line,f.from.ch+1),{className:r}));f.to&&c.getLine(f.to.line).length<=e&&d.push(c.markText(f.to,g(f.to.line,f.to.ch+1),{className:r}))}}if(d.length){b&&c.state.focused&&c.focus();l=function(){c.operation(function(){for(var b=0;b<d.length;b++)d[b].clear()})};if(!a)return l;setTimeout(l,800)}}function c(b){b.operation(function(){r&&(r(),r=null);r=f(b,!1,b.state.matchBrackets)})}var b=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||
8>document.documentMode),g=a.Pos,h={"(":")\x3e",")":"(\x3c","[":"]\x3e","]":"[\x3c","{":"}\x3e","}":"{\x3c"},r=null;a.defineOption("matchBrackets",!1,function(b,g,l){l&&l!=a.Init&&(b.off("cursorActivity",c),r&&(r(),r=null));g&&(b.state.matchBrackets="object"==typeof g?g:{},b.on("cursorActivity",c))});a.defineExtension("matchBrackets",function(){f(this,!0)});a.defineExtension("findMatchingBracket",function(b,c,a){return(a||"boolean"==typeof c)&&(a?(a.strict=c,c=a):c=c?{strict:!0}:null),m(this,b,c)});
a.defineExtension("scanForBracket",function(b,c,a,e){return q(this,b,c,a,e)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("addon/edit/matchtags.js",["../../lib/codemirror","../fold/xml-fold"],a):a(CodeMirror)})(function(a){function m(c){c.state.tagHit&&c.state.tagHit.clear();c.state.tagOther&&c.state.tagOther.clear();c.state.tagHit=c.state.tagOther=null}function q(c){c.state.failedTagMatch=!1;c.operation(function(){if(m(c),!c.somethingSelected()){var b=
c.getCursor(),g=c.getViewport();g.from=Math.min(g.from,b.line);g.to=Math.max(b.line+1,g.to);if(b=a.findMatchingTag(c,b,g))c.state.matchBothTags&&(g="open"==b.at?b.open:b.close)&&(c.state.tagHit=c.markText(g.from,g.to,{className:"CodeMirror-matchingtag"})),(b="close"==b.at?b.open:b.close)?c.state.tagOther=c.markText(b.from,b.to,{className:"CodeMirror-matchingtag"}):c.state.failedTagMatch=!0}})}function f(c){c.state.failedTagMatch&&q(c)}a.defineOption("matchTags",!1,function(c,b,g){g&&g!=a.Init&&(c.off("cursorActivity",
q),c.off("viewportChange",f),m(c));b&&(c.state.matchBothTags="object"==typeof b&&b.bothTags,c.on("cursorActivity",q),c.on("viewportChange",f),q(c))});a.commands.toMatchingTag=function(c){var b=a.findMatchingTag(c,c.getCursor());b&&(b="close"==b.at?b.open:b.close)&&c.extendSelection(b.to,b.from)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/trailingspace.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.defineOption("showTrailingSpace",!1,function(m,q,f){f==a.Init&&(f=!1);f&&!q?m.removeOverlay("trailingspace"):!f&&q&&m.addOverlay({token:function(c){for(var b=c.string.length,a=b;a&&/\s/.test(c.string.charAt(a-1));--a);return a>c.pos?(c.pos=a,null):(c.pos=b,"trailingspace")},
name:"trailingspace"})})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/foldcode",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(b,c,h,r){function p(a){var d=n(b,c);if(!d||d.to.line-d.from.line<l)return null;for(var e=b.findMarksAt(d.from),k=0;k<e.length;++k)if(e[k].__isFold&&"fold"!==r){if(!a)return null;d.cleared=!0;e[k].clear()}return d}if(h&&h.call){var n=h;h=null}else n=f(b,h,"rangeFinder");
"number"==typeof c&&(c=a.Pos(c,0));var l=f(b,h,"minFoldSize"),e=p(!0);if(f(b,h,"scanUp"))for(;!e&&c.line>b.firstLine();)c=a.Pos(c.line-1,0),e=p(!1);if(e&&!e.cleared&&"unfold"!==r){var d=q(b,h);a.on(d,"mousedown",function(b){k.clear();a.e_preventDefault(b)});var k=b.markText(e.from,e.to,{replacedWith:d,clearOnEnter:f(b,h,"clearOnEnter"),__isFold:!0});k.on("clear",function(c,d){a.signal(b,"unfold",b,c,d)});a.signal(b,"fold",b,e.from,e.to)}}function q(b,c){var a=f(b,c,"widget");if("string"==typeof a){var r=
document.createTextNode(a),a=document.createElement("span");a.appendChild(r);a.className="CodeMirror-foldmarker"}else a&&(a=a.cloneNode(!0));return a}function f(b,a,h){return a&&void 0!==a[h]?a[h]:(b=b.options.foldOptions)&&void 0!==b[h]?b[h]:c[h]}a.newFoldFunction=function(b,c){return function(a,f){m(a,f,{rangeFinder:b,widget:c})}};a.defineExtension("foldCode",function(b,c,a){m(this,b,c,a)});a.defineExtension("isFolded",function(b){b=this.findMarksAt(b);for(var c=0;c<b.length;++c)if(b[c].__isFold)return!0});
a.commands.toggleFold=function(b){b.foldCode(b.getCursor())};a.commands.fold=function(b){b.foldCode(b.getCursor(),null,"fold")};a.commands.unfold=function(b){b.foldCode(b.getCursor(),null,"unfold")};a.commands.foldAll=function(b){b.operation(function(){for(var c=b.firstLine(),f=b.lastLine();c<=f;c++)b.foldCode(a.Pos(c,0),null,"fold")})};a.commands.unfoldAll=function(b){b.operation(function(){for(var c=b.firstLine(),f=b.lastLine();c<=f;c++)b.foldCode(a.Pos(c,0),null,"unfold")})};a.registerHelper("fold",
"combine",function(){var b=Array.prototype.slice.call(arguments,0);return function(c,a){for(var f=0;f<b.length;++f){var q=b[f](c,a);if(q)return q}}});a.registerHelper("fold","auto",function(b,c){for(var a=b.getHelpers(c,"fold"),f=0;f<a.length;f++){var q=a[f](b,c);if(q)return q}});var c={rangeFinder:a.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1,clearOnEnter:!0};a.defineOption("foldOptions",null);a.defineExtension("foldOption",function(b,c){return f(this,b,c)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define("addon/fold/foldgutter.js",["../../lib/codemirror","./foldcode"],a):a(CodeMirror)})(function(a){function m(b){this.options=b;this.from=this.to=0}function q(b,c){for(var a=b.findMarks(n(c,0),n(c+1,0)),k=0;k<a.length;++k)if(a[k].__isFold&&a[k].find().from.line==c)return a[k]}function f(b){if("string"==typeof b){var c=document.createElement("div");
return c.className=b+" CodeMirror-guttermarker-subtle",c}return b.cloneNode(!0)}function c(b,c,a){var k=b.state.foldGutter.options,g=c,h=b.foldOption(k,"minFoldSize"),r=b.foldOption(k,"rangeFinder");b.eachLine(c,a,function(c){var a=null;if(q(b,g))a=f(k.indicatorFolded);else{var d=n(g,0);(d=r&&r(b,d))&&d.to.line-d.from.line>=h&&(a=f(k.indicatorOpen))}b.setGutterMarker(c,k.gutter,a);++g})}function b(b){var a=b.getViewport(),d=b.state.foldGutter;d&&(b.operation(function(){c(b,a.from,a.to)}),d.from=a.from,
d.to=a.to)}function g(b,c,a){var k=b.state.foldGutter;k&&(k=k.options,a==k.gutter&&((a=q(b,c))?a.clear():b.foldCode(n(c,0),k.rangeFinder)))}function h(c){var a=c.state.foldGutter;if(a){var d=a.options;a.from=a.to=0;clearTimeout(a.changeUpdate);a.changeUpdate=setTimeout(function(){b(c)},d.foldOnChangeTimeSpan||600)}}function r(a){var e=a.state.foldGutter;if(e){var d=e.options;clearTimeout(e.changeUpdate);e.changeUpdate=setTimeout(function(){var d=a.getViewport();e.from==e.to||20<d.from-e.to||20<e.from-
d.to?b(a):a.operation(function(){d.from<e.from&&(c(a,d.from,e.from),e.from=d.from);d.to>e.to&&(c(a,e.to,d.to),e.to=d.to)})},d.updateViewportTimeSpan||400)}}function p(b,a){var d=b.state.foldGutter;if(d){var k=a.line;k>=d.from&&k<d.to&&c(b,k,k+1)}}a.defineOption("foldGutter",!1,function(c,e,d){d&&d!=a.Init&&(c.clearGutter(c.state.foldGutter.options.gutter),c.state.foldGutter=null,c.off("gutterClick",g),c.off("change",h),c.off("viewportChange",r),c.off("fold",p),c.off("unfold",p),c.off("swapDoc",h));
if(e){d=c.state;var k=e;e=(!0===k&&(k={}),null==k.gutter&&(k.gutter="CodeMirror-foldgutter"),null==k.indicatorOpen&&(k.indicatorOpen="CodeMirror-foldgutter-open"),null==k.indicatorFolded&&(k.indicatorFolded="CodeMirror-foldgutter-folded"),k);d.foldGutter=new m(e);b(c);c.on("gutterClick",g);c.on("change",h);c.on("viewportChange",r);c.on("fold",p);c.on("unfold",p);c.on("swapDoc",h)}});var n=a.Pos});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/brace-fold.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.registerHelper("fold","brace",function(m,q){function f(d){for(var e=q.ch,k=0;;)if(e=0>=e?-1:g.lastIndexOf(d,e-1),-1!=e){if(1==k&&e<q.ch)break;if(c=m.getTokenTypeAt(a.Pos(b,e+1)),!/^(comment|string)/.test(c))return e+1;--e}else{if(1==k)break;k=1;e=g.length}}var c,b=q.line,g=
m.getLine(b),h="{",r="}",p=f("{");if(null==p&&(h="[",r="]",p=f("[")),null!=p){var n,l,e=1,d=m.lastLine(),k=b;a:for(;k<=d;++k)for(var t=m.getLine(k),u=k==b?p:0;;){var y=t.indexOf(h,u),C=t.indexOf(r,u);if(0>y&&(y=t.length),0>C&&(C=t.length),(u=Math.min(y,C))==t.length)break;if(m.getTokenTypeAt(a.Pos(k,u+1))==c)if(u==y)++e;else if(!--e){n=k;l=u;break a}++u}if(null!=n&&(b!=n||l!=p))return{from:a.Pos(b,p),to:a.Pos(n,l)}}});a.registerHelper("fold","import",function(m,q){function f(b){if(b<m.firstLine()||
b>m.lastLine())return null;var c=m.getTokenAt(a.Pos(b,1));if(/\S/.test(c.string)||(c=m.getTokenAt(a.Pos(b,c.end+1))),"keyword"!=c.type||"import"!=c.string)return null;var f=b;for(b=Math.min(m.lastLine(),b+10);f<=b;++f){var g=m.getLine(f).indexOf(";");if(-1!=g)return{startCh:c.end,end:a.Pos(f,g)}}}var c,b=q.line,g=f(b);if(!g||f(b-1)||(c=f(b-2))&&c.end.line==b-1)return null;for(c=g.end;;){var h=f(c.line+1);if(null==h)break;c=h.end}return{from:m.clipPos(a.Pos(b,g.startCh+1)),to:c}});a.registerHelper("fold",
"include",function(m,q){function f(b){if(b<m.firstLine()||b>m.lastLine())return null;var c=m.getTokenAt(a.Pos(b,1));return/\S/.test(c.string)||(c=m.getTokenAt(a.Pos(b,c.end+1))),"meta"==c.type&&"#include"==c.string.slice(0,8)?c.start+8:void 0}var c=q.line,b=f(c);if(null==b||null!=f(c-1))return null;for(var g=c;null!=f(g+1);)++g;return{from:a.Pos(c,b+1),to:m.clipPos(a.Pos(g))}})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/comment-fold.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.registerGlobalHelper("fold","comment",function(a){return a.blockCommentStart&&a.blockCommentEnd},function(m,q){var f=m.getModeAt(q),c=f.blockCommentStart,f=f.blockCommentEnd;if(c&&f){var b,g=q.line;b=m.getLine(g);for(var h=q.ch,r=0;;)if(h=0>=h?-1:b.lastIndexOf(c,h-1),-1!=
h){if(1==r&&h<q.ch)return;if(/comment/.test(m.getTokenTypeAt(a.Pos(g,h+1)))&&(0==h||b.slice(h-f.length,h)==f||!/comment/.test(m.getTokenTypeAt(a.Pos(g,h))))){b=h+c.length;break}--h}else{if(1==r)return;r=1;h=b.length}var p,n,r=1,h=m.lastLine(),l=g;a:for(;l<=h;++l)for(var e=m.getLine(l),d=l==g?b:0;;){var k=e.indexOf(c,d),t=e.indexOf(f,d);if(0>k&&(k=e.length),0>t&&(t=e.length),(d=Math.min(k,t))==e.length)break;if(d==k)++r;else if(!--r){p=l;n=d;break a}++d}if(null!=p&&(g!=p||n!=b))return{from:a.Pos(g,
b),to:a.Pos(p,n)}}})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/indent-fold.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(q,f){var c=q.getLine(f),b=c.search(/\S/);return-1==b||/\bcomment\b/.test(q.getTokenTypeAt(a.Pos(f,b+1)))?-1:a.countColumn(c,null,q.getOption("tabSize"))}a.registerHelper("fold","indent",function(q,f){var c=m(q,f.line);if(!(0>c)){for(var b=null,g=f.line+1,h=q.lastLine();g<=
h;++g){var r=m(q,g);if(-1!=r){if(!(r>c))break;b=g}}return b?{from:a.Pos(f.line,q.getLine(f.line).length),to:a.Pos(b,q.getLine(b).length)}:void 0}})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/format/autoFormatAll.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.defineExtension("autoFormatAll",function(m,q){for(var f=this,c=f.getMode(),b=f.getRange(m,q).split("\n"),g=a.copyState(c,f.getTokenAt(m).state),h=f.getOption("tabSize"),r="",p=0,n=0==m.ch,l=0;l<b.length;++l){for(var e=new a.StringStream(b[l],h);!e.eol();){var d=a.innerMode(c,
g),k=c.token(e,g),t=e.current();e.start=e.pos;n&&!/\S/.test(t)||(r+=t,n=!1);!n&&d.mode.newlineAfterToken&&d.mode.newlineAfterToken(k,t,e.string.slice(e.pos)||b[l+1]||"",d.state)&&(r+="\n",n=!0,++p)}!e.pos&&c.blankLine&&c.blankLine(g);!n&&l<b.length-1&&(r+="\n",n=!0,++p)}f.operation(function(){f.replaceRange(r,m,q);for(var b=m.line+1,c=m.line+p;b<=c;++b)f.indentLine(b,"smart");f.setCursor({line:0,ch:0})})})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/format/formatting.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(a){for(var f=[/for\s*?\((.*?)\)/g,/&#?[a-z0-9]+;[\s\S]/g,/\"(.*?)((\")|$)/g,/\/\*(.*?)(\*\/|$)/g,/^\/\/.*/g],c=[],b=0;b<f.length;b++)for(var g=0;g<a.length;){var h=a.substr(g).match(f[b]);if(null==h)break;c.push({start:g+h.index,end:g+h.index+h[0].length});g+=h.index+
Math.max(1,h[0].length)}return c.sort(function(b,c){return b.start-c.start}),c}a.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(a,f){return/^[;{}]$/.test(f)}});a.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(a){var f=0,c=this.jsonMode?function(b){return b.replace(/([,{])/g,"$1\n").replace(/}/g,"\n}")}:function(b){return b.replace(/(;|\{|\})([^\r\n;])/g,"$1\n$2")},b=m(a),g="";if(null!=b){for(var h=
0;h<b.length;h++)b[h].start>f&&(g+=c(a.substring(f,b[h].start)),f=b[h].start),b[h].start<=f&&b[h].end>=f&&(g+=a.substring(f,b[h].end),f=b[h].end);f<a.length&&(g+=c(a.substr(f)))}else g=c(a);return g.replace(/^\n*|\n*$/,"")}});a.extendMode("xml",{commentStart:"\x3c!--",commentEnd:"--\x3e",noBreak:!1,noBreakEmpty:null,tagType:"",tagName:"",isXML:!1,newlineAfterToken:function(a,f,c,b){b=!1;var g=null,h="";if(this.isXML="xml"==this.configuration,"comment"==a||/\x3c!--/.test(c))return!1;if("tag"==a){0==
f.indexOf("\x3c")&&0==!f.indexOf("\x3c/")&&(this.tagType="open",g=f.match(/^<\s*?([\w]+?)$/i),this.tagName=null!=g?g[1]:"",h=this.tagName.toLowerCase(),-1!="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")&&(this.noBreak=!0));if(0==f.indexOf("\x3e")&&"open"==this.tagType)return this.tagType="",RegExp("^"+(this.isXML?"[^\x3c]*?":"")+"\x3c/s*?"+this.tagName+"s*?\x3e","i").test(c)?(this.noBreak=!1,this.isXML||
(this.tagName=""),!1):(b=this.noBreak,this.noBreak=!1,!b);if(0==f.indexOf("\x3c/")&&(this.tagType="close",g=f.match(/^<\/\s*?([\w]+?)$/i),null!=g&&(h=g[1].toLowerCase()),-1!="|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")&&(this.noBreak=!0)),0==f.indexOf("\x3e")&&"close"==this.tagType)return this.tagType="",0==c.indexOf("\x3c")&&(g=c.match(/^<\/?\s*?([\w]+?)(\s|>)/i),h=null!=g?g[1].toLowerCase():"",-1=="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+
h+"|"))?(this.noBreak=!1,!0):(b=this.noBreak,this.noBreak=!1,!b)}return 0==c.indexOf("\x3c")&&(this.noBreak=!1,this.isXML&&""!=this.tagName?(this.tagName="",!1):(g=c.match(/^<\/?\s*?([\w]+?)(\s|>)/i),h=null!=g?g[1].toLowerCase():"",-1=="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")))}});a.defineExtension("commentRange",function(q,f,c){var b=this,g=a.innerMode(b.getMode(),b.getTokenAt(f).state).mode;b.operation(function(){if(q)b.replaceRange(g.commentEnd,
c),b.replaceRange(g.commentStart,f),b.setSelection(f,{line:c.line,ch:c.ch+g.commentStart.length+g.commentEnd.length}),f.line==c.line&&f.ch==c.ch&&b.setCursor(f.line,f.ch+g.commentStart.length);else{var a=b.getRange(f,c),r=a.indexOf(g.commentStart),p=a.lastIndexOf(g.commentEnd);-1<r&&-1<p&&p>r&&(a=a.substr(0,r)+a.substring(r+g.commentStart.length,p)+a.substr(p+g.commentEnd.length));b.replaceRange(a,f,c);b.setSelection(f,{line:c.line,ch:c.ch-g.commentStart.length-g.commentEnd.length})}})});a.defineExtension("autoIndentRange",
function(a,f){var c=this;this.operation(function(){for(var b=a.line;b<=f.line;b++)c.indentLine(b,"smart")})});a.defineExtension("autoFormatRange",function(q,f){for(var c=this,b=c.getMode(),g=c.getRange(q,f).split("\n"),h=a.copyState(b,c.getTokenAt(q).state),r=c.getOption("tabSize"),p="",n=0,l=0==q.ch,e=0;e<g.length;++e){for(var d=new a.StringStream(g[e],r);!d.eol();){var k=a.innerMode(b,h),t=b.token(d,h),m=d.current();d.start=d.pos;l&&!/\S/.test(m)||(p+=m,l=!1);!l&&k.mode.newlineAfterToken&&k.mode.newlineAfterToken(t,
m,d.string.slice(d.pos)||g[e+1]||"",k.state)&&(p+="\n",l=!0,++n)}!d.pos&&b.blankLine&&b.blankLine(h);!l&&e<g.length-1&&(p+="\n",l=!0,++n)}c.operation(function(){c.replaceRange(p,q,f);for(var b=q.line+1,a=q.line+n;b<=a;++b)c.indentLine(b,"smart");c.setSelection(q,c.getCursor(!1))})})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/selection/active-line.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(c){for(var a=0;a<c.state.activeLines.length;a++)c.removeLineClass(c.state.activeLines[a],"wrap",b),c.removeLineClass(c.state.activeLines[a],"background",g),c.removeLineClass(c.state.activeLines[a],"gutter",h)}function q(b,c){if(b.length!=c.length)return!1;for(var a=
0;a<b.length;a++)if(b[a]!=c[a])return!1;return!0}function f(c,a){for(var f=[],l=0;l<a.length;l++){var e=a[l],d=c.getOption("styleActiveLine");if("object"==typeof d&&d.nonEmpty?e.anchor.line==e.head.line:e.empty())e=c.getLineHandleVisualStart(e.head.line),f[f.length-1]!=e&&f.push(e)}q(c.state.activeLines,f)||c.operation(function(){m(c);for(var a=0;a<f.length;a++)c.addLineClass(f[a],"wrap",b),c.addLineClass(f[a],"background",g),c.addLineClass(f[a],"gutter",h);c.state.activeLines=f})}function c(b,c){f(b,
c.ranges)}var b="CodeMirror-activeline",g="CodeMirror-activeline-background",h="CodeMirror-activeline-gutter";a.defineOption("styleActiveLine",!1,function(b,g,h){h=h!=a.Init&&h;g!=h&&(h&&(b.off("beforeSelectionChange",c),m(b),delete b.state.activeLines),g&&(b.state.activeLines=[],f(b,b.listSelections()),b.on("beforeSelectionChange",c)))})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/search/searchcursor",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(b){if(!b.global){var c=b.flags;b=new RegExp(b.source,(null!=c?c:(b.ignoreCase?"i":"")+(b.global?"g":"")+(b.multiline?"m":""))+"g")}return b}function q(b,c,a){c=m(c);var e=a.line,f=a.ch;for(a=b.lastLine();e<=a;e++,f=0)if(c.lastIndex=f,f=b.getLine(e),f=c.exec(f))return{from:d(e,
f.index),to:d(e,f.index+f[0].length),match:f}}function f(b,c,a){if(!/\\s|\\n|\n|\\W|\\D|\[\^/.test(c.source))return q(b,c,a);c=m(c);for(var e,f=1,g=a.line,h=b.lastLine();g<=h;){for(var l=0;l<f;l++){var n=b.getLine(g++);e=null==e?n:e+"\n"+n}f*=2;c.lastIndex=a.ch;if(l=c.exec(e))return c=e.slice(0,l.index).split("\n"),b=l[0].split("\n"),a=a.line+c.length-1,c=c[c.length-1].length,{from:d(a,c),to:d(a+b.length-1,1==b.length?c+b[0].length:b[b.length-1].length),match:l}}}function c(b,c){for(var a,d=0;;){c.lastIndex=
d;var e=c.exec(b);if(!e||(a=e,(d=a.index+(a[0].length||1))==b.length))return a}}function b(b,a,e){a=m(a);var f=e.line,g=e.ch;for(e=b.firstLine();f>=e;f--,g=-1){var h=b.getLine(f);-1<g&&(h=h.slice(0,g));if(g=c(h,a))return{from:d(f,g.index),to:d(f,g.index+g[0].length),match:g}}}function g(b,a,e){a=m(a);for(var f,g=1,h=e.line,l=b.firstLine();h>=l;){for(var n=0;n<g;n++){var q=b.getLine(h--);f=null==f?q.slice(0,e.ch):q+"\n"+f}g*=2;if(n=c(f,a))return a=f.slice(0,n.index).split("\n"),b=n[0].split("\n"),
h+=a.length,a=a[a.length-1].length,{from:d(h,a),to:d(h+b.length-1,1==b.length?a+b[0].length:b[b.length-1].length),match:n}}}function h(b,a,c,d){if(b.length==a.length)return c;var e=0;for(a=c+Math.max(0,b.length-a.length);;){if(e==a)return e;var f=e+a>>1,g=d(b.slice(0,f)).length;if(g==c)return f;g>c?a=f:e=f+1}}function r(b,a,c,f){if(!a.length)return null;f=f?l:e;a=f(a).split(/\r|\n\r?/);var g=c.line;c=c.ch;var n=b.lastLine()+1-a.length;a:for(;g<=n;g++,c=0){var q=b.getLine(g).slice(c),m=f(q);if(1==
a.length){var p=m.indexOf(a[0]);if(-1==p)continue a;h(q,m,p,f);return{from:d(g,h(q,m,p,f)+c),to:d(g,h(q,m,p+a[0].length,f)+c)}}p=m.length-a[0].length;if(m.slice(p)==a[0]){for(var r=1;r<a.length-1;r++)if(f(b.getLine(g+r))!=a[r])continue a;var r=b.getLine(g+a.length-1),v=f(r),x=a[a.length-1];if(v.slice(0,x.length)==x)return{from:d(g,h(q,m,p,f)+c),to:d(g+a.length-1,h(r,v,x.length,f))}}}}function p(b,a,c,f){if(!a.length)return null;f=f?l:e;a=f(a).split(/\r|\n\r?/);var g=c.line,n=c.ch,q=b.firstLine()-
1+a.length;a:for(;g>=q;g--,n=-1){var m=b.getLine(g);-1<n&&(m=m.slice(0,n));n=f(m);if(1==a.length){c=n.lastIndexOf(a[0]);if(-1==c)continue a;return{from:d(g,h(m,n,c,f)),to:d(g,h(m,n,c+a[0].length,f))}}var p=a[a.length-1];if(n.slice(0,p.length)==p){var r=1;for(c=g-a.length+1;r<a.length-1;r++)if(f(b.getLine(c+r))!=a[r])continue a;c=b.getLine(g+1-a.length);r=f(c);if(r.slice(r.length-a[0].length)==a[0])return{from:d(g+1-a.length,h(c,r,c.length-a[0].length,f)),to:d(g,h(m,n,p.length,f))}}}}function n(a,
c,e,h){this.atOccurrence=!1;this.doc=a;e=e?a.clipPos(e):d(0,0);this.pos={from:e,to:e};var l;"object"==typeof h?l=h.caseFold:(l=h,h=null);"string"==typeof c?(null==l&&(l=!1),this.matches=function(b,d){return(b?p:r)(a,c,d,l)}):(c=m(c),h&&!1===h.multiline?this.matches=function(d,e){return(d?b:q)(a,c,e)}:this.matches=function(b,d){return(b?g:f)(a,c,d)})}var l,e,d=a.Pos;String.prototype.normalize?(l=function(a){return a.normalize("NFD").toLowerCase()},e=function(a){return a.normalize("NFD")}):(l=function(a){return a.toLowerCase()},
e=function(a){return a});n.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(b){for(var c=this.matches(b,this.doc.clipPos(b?this.pos.from:this.pos.to));c&&0==a.cmpPos(c.from,c.to);)b?c.from.ch?c.from=d(c.from.line,c.from.ch-1):c=c.from.line==this.doc.firstLine()?null:this.matches(b,this.doc.clipPos(d(c.from.line-1))):c.to.ch<this.doc.getLine(c.to.line).length?c.to=d(c.to.line,c.to.ch+1):c=c.to.line==this.doc.lastLine()?null:this.matches(b,
d(c.to.line+1,0));if(c)return this.pos=c,this.atOccurrence=!0,this.pos.match||!0;b=d(b?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:b,to:b},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(b,c){if(this.atOccurrence){var e=a.splitLines(b);this.doc.replaceRange(e,this.pos.from,this.pos.to,c);this.pos.to=d(this.pos.from.line+e.length-1,e[e.length-1].length+(1==e.length?this.pos.from.ch:
0))}}};a.defineExtension("getSearchCursor",function(b,c,a){return new n(this.doc,b,c,a)});a.defineDocExtension("getSearchCursor",function(b,c,a){return new n(this,b,c,a)});a.defineExtension("selectMatches",function(b,c){for(var d=[],e=this.getSearchCursor(b,this.getCursor("from"),c);e.findNext()&&!(0<a.cmpPos(e.to(),this.getCursor("to")));)d.push({anchor:e.from(),head:e.to()});d.length&&this.setSelections(d,0)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/scroll/annotatescrollbar",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){function m(a,f){function c(a){clearTimeout(b.doRedraw);b.doRedraw=setTimeout(function(){b.redraw()},a)}this.cm=a;this.options=f;this.buttonHeight=f.scrollButtonHeight||a.getOption("scrollButtonHeight");this.annotations=[];this.doRedraw=this.doUpdate=null;this.div=a.getWrapperElement().appendChild(document.createElement("div"));
this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none";this.computeScale();var b=this;a.on("refresh",this.resizeHandler=function(){clearTimeout(b.doUpdate);b.doUpdate=setTimeout(function(){b.computeScale()&&c(20)},100)});a.on("markerAdded",this.resizeHandler);a.on("markerCleared",this.resizeHandler);!1!==f.listenForChanges&&a.on("change",this.changeHandler=function(){c(250)})}a.defineExtension("annotateScrollbar",function(a){return"string"==typeof a&&(a={className:a}),
new m(this,a)});a.defineOption("scrollButtonHeight",0);m.prototype.computeScale=function(){var a=this.cm,a=(a.getWrapperElement().clientHeight-a.display.barHeight-2*this.buttonHeight)/a.getScrollerElement().scrollHeight;if(a!=this.hScale)return this.hScale=a,!0};m.prototype.update=function(a){this.annotations=a;this.redraw()};m.prototype.redraw=function(a){function f(a,b){return p!=a.line&&(p=a.line,n=c.getLineHandle(p)),n.widgets&&n.widgets.length||h&&n.height>m?c.charCoords(a,"local")[b?"top":"bottom"]:
c.heightAtLine(n,"local")+(b?0:n.height)}!1!==a&&this.computeScale();var c=this.cm;a=this.hScale;var b=document.createDocumentFragment(),g=this.annotations,h=c.getOption("lineWrapping"),m=h&&1.5*c.defaultTextHeight(),p=null,n=null,l=c.lastLine();if(c.display.barWidth)for(var e,d=0;d<g.length;d++){var k=g[d];if(!(k.to.line>l)){for(var t=e||f(k.from,!0)*a,u=f(k.to,!1)*a;d<g.length-1&&!(g[d+1].to.line>l)&&!((e=f(g[d+1].from,!0)*a)>u+.9);)k=g[++d],u=f(k.to,!1)*a;if(u!=t){var u=Math.max(u-t,3),y=b.appendChild(document.createElement("div"));
y.style.cssText="position: absolute; right: 0px; width: "+Math.max(c.display.barWidth-1,2)+"px; top: "+(t+this.buttonHeight)+"px; height: "+u+"px";y.className=this.options.className;k.id&&y.setAttribute("annotation-id",k.id)}}}this.div.textContent="";this.div.appendChild(b)};m.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler);this.cm.off("markerAdded",this.resizeHandler);this.cm.off("markerCleared",this.resizeHandler);this.changeHandler&&this.cm.off("change",this.changeHandler);
this.div.parentNode.removeChild(this.div)}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define("addon/search/matchesonscrollbar",["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],a):a(CodeMirror)})(function(a){function m(a,c,b,g){this.cm=a;this.options=g;var h={listenForChanges:!1},m;for(m in g)h[m]=g[m];h.className||(h.className="CodeMirror-search-match");this.annotation=
a.annotateScrollbar(h);this.query=c;this.caseFold=b;this.gap={from:a.firstLine(),to:a.lastLine()+1};this.matches=[];this.update=null;this.findMatches();this.annotation.update(this.matches);var p=this;a.on("change",this.changeHandler=function(a,b){p.onChange(b)})}function q(a,c,b){return a<=c?a:Math.max(c,a+b)}a.defineExtension("showMatchesOnScrollbar",function(a,c,b){return"string"==typeof b&&(b={className:b}),b||(b={}),new m(this,a,c,b)});m.prototype.findMatches=function(){if(this.gap){for(var f=
0;f<this.matches.length;f++){var c=this.matches[f];if(c.from.line>=this.gap.to)break;c.to.line>=this.gap.from&&this.matches.splice(f--,1)}for(var b=this.cm.getSearchCursor(this.query,a.Pos(this.gap.from,0),this.caseFold),g=this.options&&this.options.maxMatches||1E3;b.findNext();){c={from:b.from(),to:b.to()};if(c.from.line>=this.gap.to)break;if(this.matches.splice(f++,0,c),this.matches.length>g)break}this.gap=null}};m.prototype.onChange=function(f){var c=f.from.line,b=a.changeEnd(f).line,g=b-f.to.line;
if(this.gap?(this.gap.from=Math.min(q(this.gap.from,c,g),f.from.line),this.gap.to=Math.max(q(this.gap.to,c,g),f.from.line)):this.gap={from:f.from.line,to:b+1},g)for(f=0;f<this.matches.length;f++){var b=this.matches[f],h=q(b.from.line,c,g);h!=b.from.line&&(b.from=a.Pos(h,b.from.ch));h=q(b.to.line,c,g);h!=b.to.line&&(b.to=a.Pos(h,b.to.ch))}clearTimeout(this.update);var m=this;this.update=setTimeout(function(){m.updateAfterChange()},250)};m.prototype.updateAfterChange=function(){this.findMatches();this.annotation.update(this.matches)};
m.prototype.clear=function(){this.cm.off("change",this.changeHandler);this.annotation.clear()}});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define("addon/search/match-highlighter.js",["../../lib/codemirror","./matchesonscrollbar"],a):a(CodeMirror)})(function(a){function m(a){this.options={};for(var b in p)this.options[b]=(a&&a.hasOwnProperty(b)?a:p)[b];this.matchesonscroll=this.overlay=this.timeout=null;this.active=!1}function q(a){var b=a.state.matchHighlighter;(b.active||
a.hasFocus())&&c(a,b)}function f(a){var b=a.state.matchHighlighter;b.active||(b.active=!0,c(a,b))}function c(a,b){clearTimeout(b.timeout);b.timeout=setTimeout(function(){h(a)},b.options.delay)}function b(a,b,c,d){var f=a.state.matchHighlighter;if(a.addOverlay(f.overlay=r(b,c,d)),f.options.annotateScrollbar&&a.showMatchesOnScrollbar)f.matchesonscroll=a.showMatchesOnScrollbar(c?new RegExp("\\b"+b+"\\b"):b,!1,{className:"CodeMirror-selection-highlight-scrollbar"})}function g(a){var b=a.state.matchHighlighter;
b.overlay&&(a.removeOverlay(b.overlay),b.overlay=null,b.matchesonscroll&&(b.matchesonscroll.clear(),b.matchesonscroll=null))}function h(a){a.operation(function(){var c=a.state.matchHighlighter;if(g(a),!a.somethingSelected()&&c.options.showToken){for(var e=!0===c.options.showToken?/[\w$]/:c.options.showToken,d=a.getCursor(),f=a.getLine(d.line),h=d=d.ch;d&&e.test(f.charAt(d-1));)--d;for(;h<f.length&&e.test(f.charAt(h));)++h;return void(d<h&&b(a,f.slice(d,h),e,c.options.style))}e=a.getCursor("from");
f=a.getCursor("to");if((d=e.line==f.line)&&!(d=!c.options.wordsOnly))a:if(null!==a.getRange(e,f).match(/^\w+$/)){if(0<e.ch&&(d={line:e.line,ch:e.ch-1},d=a.getRange(d,e),null===d.match(/\W/))){d=!1;break a}if(f.ch<a.getLine(e.line).length&&(d={line:f.line,ch:f.ch+1},d=a.getRange(f,d),null===d.match(/\W/))){d=!1;break a}d=!0}else d=!1;d&&(e=a.getRange(e,f),c.options.trim&&(e=e.replace(/^\s+|\s+$/g,"")),e.length>=c.options.minChars&&b(a,e,!1,c.options.style))})}function r(a,b,c){return{token:function(d){var f;
if(f=d.match(a))(f=!b)||(f=!(d.start&&b.test(d.string.charAt(d.start-1))||d.pos!=d.string.length&&b.test(d.string.charAt(d.pos))));if(f)return c;d.next();d.skipTo(a.charAt(0))||d.skipToEnd()}}}var p={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};a.defineOption("highlightSelectionMatches",!1,function(b,c,e){if(e&&e!=a.Init&&(g(b),clearTimeout(b.state.matchHighlighter.timeout),b.state.matchHighlighter=null,b.off("cursorActivity",q),b.off("focus",
f)),c)c=b.state.matchHighlighter=new m(c),b.hasFocus()?(c.active=!0,h(b)):b.on("focus",f),b.on("cursorActivity",q)})});
(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/mode/multiplex.js",["../../lib/codemirror"],a):a(CodeMirror)})(function(a){a.multiplexingMode=function(m){function q(a,b,f,h){return"string"==typeof b?(f=a.indexOf(b,f),h&&-1<f?f+b.length:f):(b=b.exec(f?a.slice(f):a))?b.index+f+(h?b[0].length:0):-1}var f=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:a.startState(m),
innerActive:null,inner:null}},copyState:function(c){return{outer:a.copyState(m,c.outer),innerActive:c.innerActive,inner:c.innerActive&&a.copyState(c.innerActive.mode,c.inner)}},token:function(c,b){if(b.innerActive){var g=b.innerActive,h=c.string;if(!g.close&&c.sol())return b.innerActive=b.inner=null,this.token(c,b);var r=g.close?q(h,g.close,c.pos,g.parseDelimiters):-1;if(r==c.pos&&!g.parseDelimiters)return c.match(g.close),b.innerActive=b.inner=null,g.delimStyle&&g.delimStyle+" "+g.delimStyle+"-close";
-1<r&&(c.string=h.slice(0,r));var p=g.mode.token(c,b.inner);return-1<r&&(c.string=h),r==c.pos&&g.parseDelimiters&&(b.innerActive=b.inner=null),g.innerStyle&&(p=p?p+" "+g.innerStyle:g.innerStyle),p}g=1/0;h=c.string;for(p=0;p<f.length;++p){var n=f[p],r=q(h,n.open,c.pos);if(r==c.pos)return n.parseDelimiters||c.match(n.open),b.innerActive=n,b.inner=a.startState(n.mode,m.indent?m.indent(b.outer,""):0),n.delimStyle&&n.delimStyle+" "+n.delimStyle+"-open";-1!=r&&r<g&&(g=r)}g!=1/0&&(c.string=h.slice(0,g));
r=m.token(c,b.outer);return g!=1/0&&(c.string=h),r},indent:function(c,b){var f=c.innerActive?c.innerActive.mode:m;return f.indent?f.indent(c.innerActive?c.inner:c.outer,b):a.Pass},blankLine:function(c){var b=c.innerActive?c.innerActive.mode:m;if(b.blankLine&&b.blankLine(c.innerActive?c.inner:c.outer),c.innerActive)"\n"===c.innerActive.close&&(c.innerActive=c.inner=null);else for(var g=0;g<f.length;++g){var h=f[g];"\n"===h.open&&(c.innerActive=h,c.inner=a.startState(h.mode,b.indent?b.indent(c.outer,
""):0))}},electricChars:m.electricChars,innerMode:function(a){return a.inner?{state:a.inner,mode:a.innerActive.mode}:{state:a.outer,mode:m}}}}});
(function(a){"function"==typeof a.define&&a.define("addons","addon/comment/continuecomment.js addon/edit/closebrackets.js addon/edit/closetag.js addon/edit/matchbrackets.js addon/edit/matchtags.js addon/edit/trailingspace.js addon/fold/foldgutter.js addon/fold/brace-fold.js addon/fold/comment-fold.js addon/fold/indent-fold.js addon/format/autoFormatAll.js addon/format/formatting.js addon/selection/active-line.js addon/search/match-highlighter.js addon/mode/multiplex.js".split(" "),function(){})})(this);
